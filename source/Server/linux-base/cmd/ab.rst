.. _ab-cmd:

===================
ab
===================

:Date: 2018-08-29

.. contents::


.. _ab-format:

命令格式
===================

命令格式:
    ab [options] [http[s]://]hostname[:port]/path

.. _ab-user:

所属用户
===================

命令路径:
    /usr/bin/ab

需要权限:
    普通用户权限即可执行

.. _ab-guid:

使用指导
===================

ab命令是Apache的Web服务器的性能测试工具，它可以测试安装Web服务器每秒种处理的HTTP请求。

ab命令是软件包 ``httpd-tools`` 提供的工具。

.. tip::
    查看方法：
        ``yum provides */ab``

.. _ab-args:

参数
===================

**参数及参数作用：**

=================== =====================================================================================================================================
**参数**                **作用**
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-n requests         用于指定压力测试总共的执行次数。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-c concurrency      用于指定压力测试的并发数。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-t timelimit        等待响应的最大时间(单位：秒)。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-b windowsize       TCP发送/接收的缓冲大小(单位：字节)。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-p postfile         发送POST请求时需要上传的文件，此外还必须设置-T参数。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-u putfile          发送PUT请求时需要上传的文件，此外还必须设置-T参数。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-T content-type     用于设置Content-Type请求头信息，例如：application/x-www-form-urlencoded，默认值为text/plain。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-v verbosity        指定打印帮助信息的冗余级别。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-w                  以HTML表格形式打印结果。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-i                  使用HEAD请求代替GET请求。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-x attributes       插入字符串作为table标签的属性。-y插入字符串作为tr标签的属性。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-y attributes       插入字符串作为tr标签的属性。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-z attributes       插入字符串作为td标签的属性。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-C attributes       添加cookie信息，例如："Apache=1234"(可以重复该参数选项以添加多个)。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-H attributes       添加任意的请求头，例如："Accept-Encoding: gzip"，请求头将会添加在现有的多个请求头之后(可以重复该参数选项以添加多个)。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-A attributes       添加一个基本的网络认证信息，用户名和密码之间用英文冒号隔开。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-P attributes       添加一个基本的代理认证信息，用户名和密码之间用英文冒号隔开。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-X proxy:port       指定使用的代理服务器和端口号，例如:"126.10.10.3:88"。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-V                  打印版本号并退出。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-k                  使用HTTP的KeepAlive特性。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-d                  不显示百分比。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-S                  不显示预估和警告信息。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-g filename         输出结果信息到gnuplot格式的文件中。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-e filename         输出结果信息到CSV格式的文件中。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-r                  指定接收到错误信息时不退出程序。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-h                  显示用法信息，其实就是ab -help。
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-Z ciphersuite      指定加密组件，可以参考openssl
------------------- -------------------------------------------------------------------------------------------------------------------------------------
-f protocol         使用指定的SSL/TLS 协议(SSL2, SSL3, TLS1, or ALL)
=================== =====================================================================================================================================


.. _ab-instance:

参考实例
===================

.. code-block:: bash
    :linenos:

    [root@zzjlogin ~]# ab -c 1000 -n 1000 http://www.baidu.com/index.html   
    This is ApacheBench, Version 2.3 <$Revision: 655654 $>
    Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
    Licensed to The Apache Software Foundation, http://www.apache.org/

    Benchmarking www.baidu.com (be patient)
    Completed 100 requests
    Completed 200 requests
    Completed 300 requests
    apr_socket_recv: Connection refused (111)
    Total of 309 requests completed


.. code-block:: bash
    :linenos:

    [root@zzjlogin ~]# ab -n 1000 -c 1000 http://192.168.161.132/index.html
    This is ApacheBench, Version 2.3 <$Revision: 655654 $>
    Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
    Licensed to The Apache Software Foundation, http://www.apache.org/

    Benchmarking 192.168.161.132 (be patient)
    Completed 100 requests
    Completed 200 requests
    Completed 300 requests
    Completed 400 requests
    Completed 500 requests
    Completed 600 requests
    Completed 700 requests
    Completed 800 requests
    Completed 900 requests
    Completed 1000 requests
    Finished 1000 requests


    Server Software:        nginx/1.14.0
    Server Hostname:        192.168.161.132
    Server Port:            80

    Document Path:          /index.html
    Document Length:        612 bytes

    Concurrency Level:      1000
    Time taken for tests:   0.072 seconds
    Complete requests:      1000
    Failed requests:        0
    Write errors:           0
    Total transferred:      845000 bytes
    HTML transferred:       612000 bytes
    Requests per second:    13810.63 [#/sec] (mean)
    Time per request:       72.408 [ms] (mean)
    Time per request:       0.072 [ms] (mean, across all concurrent requests)
    Transfer rate:          11396.47 [Kbytes/sec] received

    Connection Times (ms)
                min  mean[+/-sd] median   max
    Connect:        0   24   2.4     24      29
    Processing:    16   20   2.7     20      27
    Waiting:        0   17   4.8     18      27
    Total:         25   44   1.6     44      47

    Percentage of the requests served within a certain time (ms)
    50%     44
    66%     44
    75%     45
    80%     46
    90%     46
    95%     47
    98%     47
    99%     47
    100%     47 (longest request)


.. _ab-relevant:

相关命令
===================












