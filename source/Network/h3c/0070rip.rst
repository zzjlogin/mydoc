.. _network_h3c_rip:

======================================================================================================================================================
RIP配置
======================================================================================================================================================


.. contents::


RIP
======================================================================================================================================================

- RIP是距离矢量路由协议。
- RIP是内部网关协议（IGP）
- RIP使用UDP的520端口
- RIP直连网络跳数为0，最大跳数15.
- RIP为了防止环路，RIP支持水平分割和毒性反转
- H3C设备默认开启了水平分割
- 如果水平分割和毒性反转同时配置，只有毒性反转生效

在IPv4网络RIP有两个版本

RIPv1
    - 有类路由协议，只支持广播发布协议报文
    - 不支持可变长子网掩码（VLSM）和不间断的子网

RIPv2
    - 无类路由协议，支持外部路由标记，方便灵活控制
    - 保温中携带掩码信息，支持路由聚合，支持无类域间路由（CIDR）
    - 支持指定下一跳
    - 支持组播方式发送更新，且只有RIPv2路由器才能够收到协议报文，减少资源消耗。
    - 支持报文验证，验证提供MD5和明文验证两种。



RIPv1配置
======================================================================================================================================================

rip默认创建的进程号是1，也可以指定1-65525范围的数字。

从下面宣告的网络10.8.0.0，可以发现RIPv1，宣告的只能是主网络号，指定自网络号也不会生效。

.. code-block:: text
    :linenos:

    <H3C>sys
    System View: return to User View with Ctrl+Z.
    [H3C]rip
    [H3C-rip-1]network 192.168.1.0
    [H3C-rip-1]network 10.8.0.0
    [H3C-rip-1]dis this
    #
    rip 1
    network 10.0.0.0
    network 192.168.1.0
    #
    return

配置静默端口
------------------------------------------------------------------------------------------------------------------------------------------------------

.. code-block:: text
    :linenos:

    [H3C-rip-1]silent-interface GigabitEthernet 0/1




RIPv2配置
======================================================================================================================================================

.. code-block:: text
    :linenos:

    <H3C>sys
    System View: return to User View with Ctrl+Z.
    [H3C]rip
    [H3C-rip-1]
    [H3C-rip-1]version 2
    [H3C-rip-1]network 192.168.1.0
    [H3C-rip-1]network 10.8.0.0 0.0.255.255
    [H3C-rip-1]dis this
    #
    rip 1
    version 2
    network 10.8.0.0 0.0.255.255
    network 192.168.1.0
    #
    return



配置RIP认证
------------------------------------------------------------------------------------------------------------------------------------------------------

认证，是在宣告进入rip的端口配置：

.. code-block:: text
    :linenos:

    [H3C]inter g0/1
    [H3C-GigabitEthernet0/1]rip authentication-mode simple plain 12345


配置聚合子网（支持超网）
------------------------------------------------------------------------------------------------------------------------------------------------------

.. code-block:: text
    :linenos:


    [H3C]rip
    [H3C-rip-1]dis this
    #
    rip 1
    version 2
    network 10.8.0.0 0.0.255.255
    network 192.168.1.0
    #
    return
    [H3C-rip-1]no network 192.168.1.0
    [H3C-rip-1]network 192.168.0.0 0.0.255.255
    [H3C-rip-1]dis this
    #
    rip 1
    version 2
    network 10.8.0.0 0.0.255.255
    network 192.168.0.0 0.0.255.255
    #
    return



配置路由防环
------------------------------------------------------------------------------------------------------------------------------------------------------

默认开启了水平分割，可以通过下面命令关闭水平分割：
    在宣告进rip的三层接口配置关闭和开启水平分割

.. code-block:: text
    :linenos:

    [H3C]inter g0/1
    [H3C-GigabitEthernet0/1]no rip split-horizon


开启毒性逆转
------------------------------------------------------------------------------------------------------------------------------------------------------

.. code-block:: text
    :linenos:

    [H3C-GigabitEthernet0/1]rip poison-reverse









