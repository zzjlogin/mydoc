.. _python_copyreg:

======================================================================================================================================================
:mod:`copyreg` 
======================================================================================================================================================

.. contents::

copyreg
======================================================================================================================================================

copyreg模块提供了一种自定义函数来序列和反序列特定对象时使用的函数的机制。

.. code-block:: python
    :linenos:

    In [13]: import copyreg,copy,pickle

    In [14]: class C(object):
        ...:     def __init__(self,a):
        ...:         self.a=a
        ...:

    In [15]: def pickle_c(c):
        ...:     print("picking c instance...")
        ...:     return C,(c.a,)
        ...:

    In [16]: copyreg.pickle(C,pickle_c)

    In [17]: c=C(1)

    In [18]: d=copy.copy(c)
    picking c instance...

    In [19]: p= pickle.dumps(c)
    picking c instance...

    In [20]: p
    Out[20]: b'\x80\x03c__main__\nC\nq\x00K\x01\x85q\x01Rq\x02.'

