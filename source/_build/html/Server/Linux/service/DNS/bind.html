

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>8.1. bind &mdash; 张志佳的技术文档 1.0 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../../search.html" />
    <link rel="next" title="8.2. unbound" href="unbound.html" />
    <link rel="prev" title="8. DNS" href="index.html" /> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> 张志佳的技术文档
          

          
            
            <img src="../../../../_static/logo-wordmark-light.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2018-09-04
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../Language.html">编程语言学习</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../Language/Python.html">Python学习</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/01环境准备.html">1. 环境准备</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/01环境准备.html#python">1.1. 安装python</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/01环境准备.html#ipython">1.2. ipython的安装</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/01环境准备.html#id2">1.3. ipython测试</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/02内建函数.html">2. 内建函数</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/02内建函数.html#id2">2.1. 常用内置函数</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/03内置常量.html">3. 内置常量</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/04内置类型.html">4. 内置类型</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/04内置类型.html#id2">4.1. 真值测试</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/04内置类型.html#boolean">4.2. boolean操作符</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/04内置类型.html#id3">4.3. 比较操作符号</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/04内置类型.html#int-float-complex">4.4. 数据类型int,float,complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/04内置类型.html#list-tuple-range">4.5. 数据类型 list, tuple, range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/04内置类型.html#binary-sequence-types-bytes-bytearray-memoryview">4.6. Binary Sequence Types — bytes, bytearray, memoryview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/04内置类型.html#set-types-set-frozenset">4.7. Set Types — set, frozenset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/05内置异常.html">5. 内置异常</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/06文本处理.html">6. 文本处理</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/06文本处理.html#string">6.1. string</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/06文本处理.html#re">6.2. re</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/06文本处理.html#difflib">6.3. difflib</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/06文本处理.html#textwrap">6.4. textwrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/06文本处理.html#unicodedata">6.5. unicodedata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/06文本处理.html#stringprep">6.6. stringprep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/06文本处理.html#readline">6.7. readline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/06文本处理.html#rlcompleter">6.8. rlcompleter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/07二进制处理.html">7. 二进制处理</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/07二进制处理.html#struct">7.1. struct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/07二进制处理.html#codecs">7.2. codecs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/08数据类型.html">8. 数据类型</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#datetime">8.1. datetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#calendar">8.2. calendar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#collectons">8.3. collectons</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#collections-abc">8.4. collections.abc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#heapq">8.5. heapq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#bisect">8.6. bisect</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#array">8.7. array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#weakref">8.8. weakref</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#types">8.9. types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#copy">8.10. copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#pprint">8.11. pprint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#reprlib">8.12. reprlib</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#enum">8.13. enum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/08数据类型.html#flag">8.14. Flag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/09数值模块.html">9. 数值模块</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/09数值模块.html#numbers">9.1. numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/09数值模块.html#math">9.2. math</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/09数值模块.html#cmath">9.3. cmath</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/09数值模块.html#decimal">9.4. decimal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/09数值模块.html#fractions">9.5. fractions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/09数值模块.html#random">9.6. random</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/09数值模块.html#statistics">9.7. statistics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/10函数式编程模块.html">10. 函数式编程模块</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/10函数式编程模块.html#itertools">10.1. itertools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/10函数式编程模块.html#functools">10.2. functools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/10函数式编程模块.html#operator">10.3. operator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html">11. 文件和目录访问</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#pathlib">11.1. pathlib</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#os-path">11.2. os.path</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#fileinput">11.3. fileinput</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#stat">11.4. stat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#filecmp">11.5. filecmp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#tempfile">11.6. tempfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#glob">11.7. glob</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#fnmatch">11.8. fnmatch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#linecache">11.9. linecache</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#shutil">11.10. shutil</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/11文件和目录访问.html#macpath">11.11. macpath</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/12数据持久化.html">12. 数据持久化</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/12数据持久化.html#pickle">12.1. pickle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/12数据持久化.html#copyreg">12.2. copyreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/12数据持久化.html#shelve">12.3. shelve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/12数据持久化.html#marshal">12.4. marshal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/12数据持久化.html#dbm">12.5. dbm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/12数据持久化.html#sqllite">12.6. sqllite</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/13数据压缩和归档.html">13. 数据压缩和归档</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/13数据压缩和归档.html#zlib">13.1. zlib</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/13数据压缩和归档.html#gzip">13.2. gzip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/13数据压缩和归档.html#bz2">13.3. bz2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/13数据压缩和归档.html#lzma">13.4. lzma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/13数据压缩和归档.html#zipfile">13.5. zipfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/13数据压缩和归档.html#tarfile">13.6. tarfile</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/14文件格式.html">14. 文件格式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/14文件格式.html#csv">14.1. csv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/14文件格式.html#configparser">14.2. configparser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/14文件格式.html#netrc">14.3. netrc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/14文件格式.html#xdrlib">14.4. xdrlib</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/14文件格式.html#plistlib">14.5. plistlib</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/15加密服务.html">15. 加密服务</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/15加密服务.html#hashlib">15.1. hashlib</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/15加密服务.html#hmac">15.2. hmac</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/15加密服务.html#secrets">15.3. secrets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/16通用操作系统服务.html">16. 通用操作系统服务</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/16通用操作系统/16.1通用操作系统服务.html">16.1. os</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/16通用操作系统/16.2通用操作系统服务.html">16.2. io</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/16通用操作系统/16.3通用操作系统服务.html">16.3. time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/16通用操作系统/16.4通用操作系统服务.html">16.4. argparse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/16通用操作系统/16.5通用操作系统服务.html">16.5. getopt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/16通用操作系统/16.6通用操作系统服务.html">16.6. logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/16通用操作系统/16.7通用操作系统服务.html">16.7. logging.Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/16通用操作系统/16.8通用操作系统服务.html">16.8. logging.Handlers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/16通用操作系统/16.9通用操作系统服务.html">16.9. getpass</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/17并发执行.html">17. 并发执行</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/17并发执行.html#threading">17.1. threading</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/17并发执行.html#multiprocessing">17.2. multiprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/17并发执行.html#multiprocessing-process">17.3. multiprocessing.Process</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/17并发执行.html#id2">17.4. multiprocessing.Process</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/17并发执行.html#multiprocessing-queue">17.5. multiprocessing.Queue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/17并发执行.html#id3">17.6. multiprocessing.Queue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/17并发执行.html#multiprocessing-joinablequeue">17.7. multiprocessing.JoinableQueue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Python/17并发执行.html#multiprocessing-connection-connection">17.8. multiprocessing.connection.Connection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/18进程通信和网络.html">18. 进程通信和网络</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/19网络数据处理.html">19. 网络数据处理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Python/20结构化文本文档处理工具.html">20. 结构化文本文档处理工具</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Language/Algorithm.html">算法学习(Algorithm)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Algorithm/index.html">树(tree)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Algorithm/tree/indroduction.html">树(tree)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Algorithm/index.html#ccf">CCF考试</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Algorithm/ccf/201703-1.html">2017031-分蛋糕</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Algorithm/ccf/201703-2.html">2017032-学生排队</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Algorithm/ccf/201712-4.html">2017124-行车路线</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Algorithm/ccf/201803-1.html">2018031-跳一跳</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Language/Shell.html">Shell 编程</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Shell/1.base.html">1. Shell编程基础</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Shell/1.base.html#shell-about">1.1. Shell编程简介</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Shell/1.base.html#shell-demo">1.2. 入门样例</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Shell/1.base.html#shell-stander">1.3. Shell规范</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Shell/1.base.html#shell-cmd">1.4. Shell基础语句</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Language/Shell/1.base.html#id21">1.5. Shell調試</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Language/Shell/2.advance.html">2. Shell编程高级用法</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Network.html">计算机网络学习</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../Network/1.NetworkTheory.html">理论学习</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Network/2.HuaWei.html">华为</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Network/3.H3C.html">H3C(华三/新华三)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Network/4.CISCO.html">思科(CISCO)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../Server.html">服务器相关学习</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../1.AboutAndClass.html">服务器相关常识</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../2.Linux.html">Linux 服务器</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../1.cmd.html">Linux命令汇总</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/Ctrl+d.html">1. Ctrl+d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/alias.html">2. alias</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/basename.html">3. basename</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/bc.html">4. bc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/bg.html">5. bg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/cal.html">6. cal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/cat.html">7. cat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/cd.html">8. cd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/chage.html">9. chage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/chattr.html">10. chattr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/chgrp.html">11. chgrp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/chkconfig.html">12. chkconfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/chmod.html">13. chmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/chown.html">14. chown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/clear.html">15. clear</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/cp.html">16. cp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/crontab.html">17. crontab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/cut.html">18. cut</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/date.html">19. date</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/dd.html">20. dd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/df.html">21. df</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/diff.html">22. diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/dig.html">23. dig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/dirname.html">24. dirname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/dmesg.html">25. dmesg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/dos2unix.html">26. dos2unix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/du.html">27. du</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/dump.html">28. dump</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/dumpe2fs.html">29. dumpe2fs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/e2fsck.html">30. e2fsck</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/echo.html">31. echo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/eject.html">32. eject</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/exec.html">33. exec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/exit.html">34. exit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/export.html">35. export</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/fdisk.html">36. fdisk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/fg.html">37. fg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/file.html">38. file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/find.html">39. find</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/finger.html">40. finger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/free.html">41. free</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/fsck.html">42. fsck</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/grep.html">43. grep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/groupadd.html">44. groupadd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/gzip.html">45. gzip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/halt.html">46. halt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/head.html">47. head</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/history.html">48. history</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/host.html">49. host</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/hostname.html">50. hostname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/iconv.html">51. iconv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/id.html">52. id</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ifconfig.html">53. ifconfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ifdown.html">54. ifdown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ifup.html">55. ifup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/init.html">56. init</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/iostat.html">57. iostat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ipcrm.html">58. ipcrm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ipcs.html">59. ipcs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/jobs.html">60. jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/join.html">61. join</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/kill.html">62. kill</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/killall.html">63. killall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/last.html">64. last</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/lastlog.html">65. lastlog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/less.html">66. less</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/locate.html">67. locate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/logout.html">68. logout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ls.html">69. ls</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/lsattr.html">70. lsattr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/lsof.html">71. lsof</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ltrace.html">72. ltrace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/mail.html">73. mail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/md5sum.html">74. md5sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/mkdir.html">75. mkdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/mkfs.html">76. mkfs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/mkswap.html">77. mkswap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/more.html">78. more</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/mount.html">79. mount</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/mpstat.html">80. mpstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/mutt.html">81. mutt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/mv.html">82. mv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/nc.html">83. nc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/netstat.html">84. netstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/nice.html">85. nice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/nmap.html">86. nmap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/nohup.html">87. nohup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/nslookup.html">88. nslookup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/parted.html">89. parted</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/partprobe.html">90. partprobe</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/passwd.html">91. passwd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/paste.html">92. paste</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/pgrep.html">93. pgrep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ping.html">94. ping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/pkill.html">95. pkill</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/poweroff.html">96. poweroff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/printf.html">97. printf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ps.html">98. ps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/pstree.html">99. pstree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/pwd.html">100. pwd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/rename.html">101. rename</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/resize2fs.html">102. resize2fs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/rev.html">103. rev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/rm.html">104. rm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/rmdir.html">105. rmdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/route.html">106. route</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/rpm.html">107. rpm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/runlevel.html">108. runlevel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/sar.html">109. sar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/scp.html">110. scp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/service.html">111. service</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/shutdown.html">112. shutdown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/sort.html">113. sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/split.html">114. split</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ss.html">115. ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/ssh.html">116. ssh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/stat.html">117. stat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/strace.html">118. strace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/su.html">119. su</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/sudo.html">120. sudo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/swapoff.html">121. swapoff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/swapon.html">122. swapon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/sync.html">123. sync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/tac.html">124. tac</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/tail.html">125. tail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/tar.html">126. tar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/tcpdump.html">127. tcpdump</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/telnet.html">128. telnet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/time.html">129. time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/top.html">130. top</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/touch.html">131. touch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/tr.html">132. tr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/traceroute.html">133. traceroute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/tree.html">134. tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/type.html">135. type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/umask.html">136. umask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/umount.html">137. umount</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/unalias.html">138. unalias</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/uname.html">139. uname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/uniq.html">140. uniq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/unset.html">141. unset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/unzip.html">142. unzip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/uptime.html">143. uptime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/useradd.html">144. useradd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/userdel.html">145. userdel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/usermod.html">146. usermod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/users.html">147. users</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/vi.html">148. vi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/vimdiff.html">149. vimdiff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/visudo.html">150. visudo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/vmstat.html">151. vmstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/w.html">152. w</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/watch.html">153. watch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/wc.html">154. wc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/wget.html">155. wget</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/whereis.html">156. whereis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/which.html">157. which</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/who.html">158. who</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/whoami.html">159. whoami</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/xargs.html">160. xargs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/yum.html">161. yum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cmd/zip.html">162. xxxx</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../2.base.html">Linux基础</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../base/01-Linux简介.html">1. Linux 简介</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/02-Linux入门.html">2. 计算机简述</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/03-文件系统.html">3. Linux文件系统</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/04-Bash特性.html">4. bash的基础特性</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/05-linux用户组管理.html">5. linux用户和组管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/07-grep正则表达式.html">6. grep正则表达式</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/08-Linux文件查找.html">7. Linux文件查找</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/09-Vim编辑器.html">8. Vim编辑器</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/10-Linux磁盘管理.html">9. Linux磁盘管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/11-Linux文件权限.html">10. Linux文件权限</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/12-RAID.html">11. RAID</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/13-LVM.html">12. LVM逻辑卷 </a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/14-Btrfs文件系统.html">13. Btrfs文件系统</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/15-解压缩.html">14. 解压缩</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/16-Linux程序包管理.html">15. Linux程序包管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/16-Linux系统程序包管理.html">16. Linux系统程序包管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/17-Linux系统网络属性管理.html">17. Linux系统网络属性管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/17-Linux系统网络管理.html">18. Linux系统网络管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/18-Linux进程管理.html">19. Linux进程管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/19-Linux任务计划.html">20. Linux任务计划</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/20-CentOS启动流程与Grub.html">21. CentOS启动流程与Grub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/21-Linux Kernel.html">22. Linux Kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/22-文本处理工具之sed,awk.html">23. 文本处理工具之sed,awk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/23-Openssl.html">24. Openssl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/24-Nssitch、pam.html">25. Nssitch、pam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/25-文件共享服务.html">26. 文件共享服务</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/26-DNS域名解析服务.html">27. DNS域名解析服务</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/27-Linux系统防火墙.html">28. Linux系统防火墙</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/28-LinuxSyslog系统日志管理.html">29. Linux Syslog系统日志管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../base/29-WebServices.html">30. Web Service</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="../../3.service.html">Linux服务器</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../DHCP/index.html">1. dhcp服务</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Rsync同步/index.html">2. Rsync同步</a></li>
<li class="toctree-l4"><a class="reference internal" href="../自动化安装/index.html">3. 自动化安装</a></li>
<li class="toctree-l4"><a class="reference internal" href="../自动化运维/index.html">4. 自动化运维</a></li>
<li class="toctree-l4"><a class="reference internal" href="../安全和监控/index.html">5. 安全和监控</a></li>
<li class="toctree-l4"><a class="reference internal" href="../远程登陆/index.html">6. 远程登陆</a></li>
<li class="toctree-l4"><a class="reference internal" href="../认证/index.html">7. 认证</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">8. DNS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../数据库/index.html">9. 数据库</a></li>
<li class="toctree-l4"><a class="reference internal" href="../WEB/index.html">10. WEB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../日志管理/index.html">11. 日志管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../网络文件共享/index.html">12. 网络文件共享</a></li>
<li class="toctree-l4"><a class="reference internal" href="../版本控制/index.html">13. 版本控制</a></li>
<li class="toctree-l4"><a class="reference internal" href="../集群/index.html">14. 集群</a></li>
<li class="toctree-l4"><a class="reference internal" href="../容器/index.html">15. 容器</a></li>
<li class="toctree-l4"><a class="reference internal" href="../虚拟化/index.html">16. 虚拟化</a></li>
<li class="toctree-l4"><a class="reference internal" href="../杂项/index.html">17. 杂项</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3.Unix.html">Unix 和类Unix</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../4.Windows.html">Windows 服务器</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../5.Optimization.html">服务器优化</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../6.FAQ.html">常见问题及解决(FAQ)</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Data.html">数据相关/大数据</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../Data/index.html">数据相关/大数据</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../MachineLearning.html">机器学习</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../MachineLearning/index.html">机器学习入门</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ToolsOpenSource.html">工具和开源项目</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../ToolsOpenSource/1.Tools.html">常用工具汇总</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ToolsOpenSource/Tools/index.html">用reStructuredText实践</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../ToolsOpenSource/Tools/rST/1.index.html">1. rST简介</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../ToolsOpenSource/Tools/rST/2.install.html">2. reST安装及环境配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../ToolsOpenSource/Tools/rST/3.grammar.html">3. reST语法学习</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../ToolsOpenSource/Tools/rST/4.toOthers.html">4. 格式转换</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../ToolsOpenSource/Tools/rST/5.API.html">5. 文档API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../ToolsOpenSource/Tools/rST/6.rstTools.html">6. reST工具</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../ToolsOpenSource/Tools/rST/7.addFunctions.html">7. 其他</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ToolsOpenSource/Tools/index.html#markdown">用MarkDown实践</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../ToolsOpenSource/Tools/MarkDown/MarkDownTools.html">1. MarkDown常用工具</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ToolsOpenSource/2.OpenSource.html">关注的开源项目</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Others.html">其他杂项</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../Others/index.html">电脑疑难杂症</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../log.html">更新日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../AboutMe.html">关于我</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">张志佳的技术文档</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../Server.html">服务器相关学习</a> &raquo;</li>
        
          <li><a href="../../../2.Linux.html">Linux 服务器</a> &raquo;</li>
        
          <li><a href="../../3.service.html">Linux服务器</a> &raquo;</li>
        
          <li><a href="../index.html">&lt;no title&gt;</a> &raquo;</li>
        
          <li><a href="index.html">8. DNS</a> &raquo;</li>
        
      <li>8.1. bind</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="unbound.html" class="btn btn-neutral float-right" title="8.2. unbound" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="8. DNS" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bind">
<h1>8.1. bind<a class="headerlink" href="#bind" title="永久链接至标题">¶</a></h1>
<div class="section" id="dns">
<h2>8.1.1. dns简介<a class="headerlink" href="#dns" title="永久链接至标题">¶</a></h2>
<p>DNS（domain name service ）是域名解析服务，工作在应用层，是c/s结构，监听于53端口。</p>
<ul class="simple">
<li>tcp 53: 用于区域传输</li>
<li>ucp 53: 用于查询</li>
</ul>
</div>
<div class="section" id="id1">
<h2>8.1.2. 常见概念<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<p>BIND(Bekerley Internet Name Domain) 是伯克利互联网名称域。提供了DNS服务。</p>
<p>DNS查询类型：</p>
<ul class="simple">
<li>递归查询</li>
<li>迭代查询</li>
</ul>
<p>服务器类型：</p>
<ul class="simple">
<li>主dns:      管理和负责解析域的服务器</li>
<li>从dns：     从服务器从主服务器复制库</li>
<li>缓存dns：   缓存dns</li>
</ul>
<p>区域传输：</p>
<ul class="simple">
<li>完全传输：   传输整个库</li>
<li>增量传输：    传递变化的部分内容</li>
</ul>
<p>解析流程：</p>
<p>client-&gt;hosts-&gt;local dns cache-&gt;dns server -&gt; server cache-&gt; root -&gt; 二级域</p>
<p>解析答案：</p>
<ul class="simple">
<li>肯定答案： 有对应条目</li>
<li>否定答案： 没有对应条目</li>
<li>权威答案： 请求的主机就有对应的条目</li>
<li>非权威答案： 请求的主机没有，通过迭代找到的答案</li>
</ul>
</div>
<div class="section" id="id2">
<h2>8.1.3. 资源记录<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<div class="section" id="id3">
<h3>8.1.3.1. 资源记录类型<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>A:            ipv4</li>
<li>AAAA:         ipv6</li>
<li>PTR:          ip-&gt;fqdn</li>
<li>SOA:          起始授权记录</li>
<li>NS:           域名</li>
<li>CNAME:        别名</li>
<li>MX:           邮件</li>
</ul>
</div>
<div class="section" id="id4">
<h3>8.1.3.2. 资源记录格式：<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name [ttl] IN rr_type value
# ttl可以从全局继承
# @引用当前区域的名字。
# 同一个名字可以通过多条记录定义多个值，dns会轮训响应
# 一条记录的对应位置没有写，会自动集成上一行的对应设置。
</pre></div>
</div>
</div>
<div class="section" id="soa">
<h3>8.1.3.3. SOA记录：<a class="headerlink" href="#soa" title="永久链接至标题">¶</a></h3>
<p>name: 就是当前域的名字， 例如“linuxpanda.tech.”</p>
<p>value: 这个value由多个部分组成，当前的fqdn,邮箱地址，还有相关设置。</p>
<p>样例：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>linuxpanda.tech. 866400 IN SOA ns.linuxpanda.tech. nsadmin.linuxpanda.tech. (
                                                    20180117 ; 序列号
                                                    2H       ; 刷新时间
                                                    10M      ; 重试时间
                                                    1W       ; 过期时间
                                                    1D       ; 否定答案的ttl时间
                                                    )
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">SOA记录必须是第一条记录。</p>
</div>
</div>
<div class="section" id="mx">
<h3>8.1.3.4. MX记录<a class="headerlink" href="#mx" title="永久链接至标题">¶</a></h3>
<p>样例：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>linuxpanda.tech. 86400 IN MX 10 mx1.linuxpanda.tech.
linuxpanda.tech. 86400 IN MX 20 mx2.linuxpanda.tech.
</pre></div>
</div>
<p>mx是有优先级的，数值越大优先级越低</p>
</div>
<div class="section" id="a">
<h3>8.1.3.5. A记录<a class="headerlink" href="#a" title="永久链接至标题">¶</a></h3>
<p>样例：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>www            IN                A        1.1.1.1
www            IN                A        2.2.2.2
</pre></div>
</div>
<p>上面的www是主机名，完成的名字是www.linuxpanda.tech. 因为我们的域是linuxpanda.tech. 可以省去后面的不写，只写主机名即可。</p>
<p>如果主机过多，可以使用生成器</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$GENERATE 10-20   www$        A           192.168.46.$
</pre></div>
</div>
<p>上面的相当于www10对应10，www11对应11等等。</p>
<p>如果避免用户写错主机名导致无法访问的问题，可以考虑使用泛域名解析</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>*.linuxpanda.tech.              IN      A        192.168.46.1
</pre></div>
</div>
</div>
<div class="section" id="ptr">
<h3>8.1.3.6. PTR记录<a class="headerlink" href="#ptr" title="永久链接至标题">¶</a></h3>
<p>需要将ip反过来写的。</p>
<p>样例：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1.46.168.192.in-addr.arpa.    IN       PTR     www.linuxpanda.tech.
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>8.1.3.7. 别名记录<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>www.linxupanda.com.       IN   CNAME          web.linuxpanda.tech.
</pre></div>
</div>
</div>
</div>
<div class="section" id="id6">
<h2>8.1.4. DNS软件安装<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># yum install bind bind-utils</span>
<span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># rpm -ql bind</span>
<span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># rpm -ql bind-utils</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2>8.1.5. 正向解析<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<div class="section" id="id8">
<h3>8.1.5.1. 编辑默认配置文件<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># vim /etc/named.conf</span>
<span class="c1">#注释以下行，使用//注释</span>
//      listen-on port <span class="m">53</span> <span class="o">{</span> <span class="m">127</span>.0.0.1<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
//      allow-query     <span class="o">{</span> localhost<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
<span class="c1"># 修改下面2项为no</span>
    dnssec-enable no<span class="p">;</span>
    dnssec-validation no<span class="p">;</span>

<span class="c1"># 在主配置文件添加对应的区域</span>
<span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones</span>
<span class="c1"># 添加如下几行</span>
zone <span class="s2">&quot;linuxpanda.tech&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> master<span class="p">;</span>
        file <span class="s2">&quot;linuxpanda.tech.zone&quot;</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>主要配置含义：</p>
<ul class="simple">
<li>listen-on：是监听配置，我们注释掉之后就是监听本机所有ip了，</li>
<li>allow-query: 这个是允许那个主机查询，注释掉就是允许所有的，如果只是想本网使用可以修改为192.168.46.0/24即可。</li>
</ul>
<p>如果不修改listen-on选项，默认只是鉴定在127.0.0.1上的。</p>
</div>
<div class="section" id="id9">
<h3>8.1.5.2. 添加区域文件<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># cp named.localhost linuxpanda.tech.zone -p      # -p选项保留权限信息，权限不对dns是没法工作的。</span>
<span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># ll                                              # 检查下权限</span>
total <span class="m">20</span>
drwxrwx---. <span class="m">2</span> named named    <span class="m">6</span> Aug  <span class="m">4</span> <span class="m">16</span>:13 data
drwxrwx---. <span class="m">2</span> named named    <span class="m">6</span> Aug  <span class="m">4</span> <span class="m">16</span>:13 dynamic
-rw-r-----. <span class="m">1</span> root  named  <span class="m">152</span> Jun <span class="m">21</span>  <span class="m">2007</span> linuxpanda.tech.zone
-rw-r-----. <span class="m">1</span> root  named <span class="m">2281</span> May <span class="m">22</span>  <span class="m">2017</span> named.ca
-rw-r-----. <span class="m">1</span> root  named  <span class="m">152</span> Dec <span class="m">15</span>  <span class="m">2009</span> named.empty
-rw-r-----. <span class="m">1</span> root  named  <span class="m">152</span> Jun <span class="m">21</span>  <span class="m">2007</span> named.localhost
-rw-r-----. <span class="m">1</span> root  named  <span class="m">168</span> Dec <span class="m">15</span>  <span class="m">2009</span> named.loopback
drwxrwx---. <span class="m">2</span> named named    <span class="m">6</span> Aug  <span class="m">4</span> <span class="m">16</span>:13 slaves
<span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># vim linuxpanda.tech.zone                        # 编辑区域文件</span>
<span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># cat linuxpanda.tech.zone                        # 检查下区域文件</span>
<span class="nv">$TTL</span> 1D
@   IN SOA  ns1 nsadmin <span class="o">(</span>
                    <span class="m">0</span>           <span class="p">;</span> serial
                    1D          <span class="p">;</span> refresh
                    1H          <span class="p">;</span> retry
                    1W          <span class="p">;</span> expire
                    3H <span class="o">)</span>    <span class="p">;</span> minimum
    NS      ns1
ns1 A       <span class="m">192</span>.168.46.7
www     A       <span class="m">192</span>.168.46.7
</pre></div>
</div>
<p>“&#64;”代表的是域名“linuxpanda.tech.” 这个实在rfc1912.conf文件里面设置的。</p>
<p>第二行没有指定的项，会从上面一行继承下来。</p>
</div>
<div class="section" id="id10">
<h3>8.1.5.3. 检查配置文件<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># named-checkconf                                         # 检查主配置文件</span>
<span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># named-checkzone linuxpanda.tech linuxpanda.tech.zone    # 检查区域文件</span>
zone linuxpanda.tech/IN: loaded serial <span class="m">0</span>
OK
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h3>8.1.5.4. 重启下dns服务<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># systemctl restart named                                 # 重启服务</span>
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h3>8.1.5.5. 测试<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<p>host方式测试</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># host www.linuxpanda.tech localhost                      # 通过localhost作为dns来测试。</span>
Using domain server:
Name: localhost
Address: ::1#53
Aliases:

www.linuxpanda.tech has address <span class="m">192</span>.168.46.7
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">这里指定了localhost做为dns，如果不想指定，在/etc/resolve.conf文件添加ip即可。</p>
</div>
<p>dig方式测试</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># dig ns1.linuxpanda.tech @localhost                      # 使用dig测试</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; ns1.linuxpanda.tech @localhost
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">35168</span>
<span class="p">;;</span> flags: qr aa rd ra<span class="p">;</span> QUERY: <span class="m">1</span>, ANSWER: <span class="m">1</span>, AUTHORITY: <span class="m">1</span>, ADDITIONAL: <span class="m">1</span>        <span class="c1"># aa代表权威答案。</span>

<span class="p">;;</span> OPT PSEUDOSECTION:
<span class="p">;</span> EDNS: version: <span class="m">0</span>, flags:<span class="p">;</span> udp: <span class="m">4096</span>
<span class="p">;;</span> QUESTION SECTION:
<span class="p">;</span>ns1.linuxpanda.tech.               IN      A

<span class="p">;;</span> ANSWER SECTION:
ns1.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7

<span class="p">;;</span> AUTHORITY SECTION:
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns1.linuxpanda.tech.

<span class="p">;;</span> Query time: <span class="m">0</span> msec
<span class="p">;;</span> SERVER: ::1#53<span class="o">(</span>::1<span class="o">)</span>
<span class="p">;;</span> WHEN: Wed Jan <span class="m">17</span> <span class="m">20</span>:30:04 CST <span class="m">2018</span>
<span class="p">;;</span> MSG SIZE  rcvd: <span class="m">78</span>
</pre></div>
</div>
<p>nslookup测试</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># nslookup                                                # nslookup测试，这个工具和windows环境的使用是一样的。</span>
&gt; server localhost
Default server: localhost
Address: ::1#53
Default server: localhost
Address: <span class="m">127</span>.0.0.1#53
&gt; www.linuxpanda.tech
Server:             localhost
Address:    ::1#53

Name:       www.linuxpanda.tech
Address: <span class="m">192</span>.168.46.7
&gt; <span class="nb">exit</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">自己创建的zone文件，请确保named用户有读取权限。</p>
</div>
</div>
</div>
<div class="section" id="id13">
<h2>8.1.6. 反向解析<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h2>
<p>在主配置文件中区域</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones                            # 添加区域配置</span>
zone <span class="s2">&quot;46.168.192.in-addr.arpa&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> master<span class="p">;</span>
        file <span class="s2">&quot;192.168.46.zone&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">一定注意{}后面的;号了。最容易忘记了。</p>
</div>
<p>添加区域文件</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># cp named.loopback  192.168.46.zone -p               # 创建一个区域文件</span>
<span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># vim 192.168.46.zone                                 # 编辑</span>
<span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># cat 192.168.46.zone                                 # 检查</span>
<span class="nv">$TTL</span> 1D
@       IN SOA  ns1.linuxpanda.tech. nsadmin.linuxpanda.tech. <span class="o">(</span>
                                        <span class="m">0</span>       <span class="p">;</span> serial
                                        1D      <span class="p">;</span> refresh
                                        1H      <span class="p">;</span> retry
                                        1W      <span class="p">;</span> expire
                                        3H <span class="o">)</span>    <span class="p">;</span> minimum
        IN NS      ns1.linuxpanda.tech.
<span class="m">7</span>       IN PTR     ns1.linuxpanda.tech.
<span class="m">7</span>       IN PTR     www.linuxpanda.tech.
</pre></div>
</div>
<p>检查配置文件</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># named-checkconf                                          # 检查配置文件</span>
<span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># named-checkzone  46.168.192.in-addr.arpa 192.168.46.zone # 检查区域文件</span>
</pre></div>
</div>
<p>测试</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># rndc reload                                             # 重新加载dns配置文件</span>
server reload successful

<span class="o">[</span>root@localhost named<span class="o">]</span><span class="c1"># host 192.168.46.7 192.168.46.7                          # 测试</span>
Using domain server:
Name: <span class="m">192</span>.168.46.7
Address: <span class="m">192</span>.168.46.7#53
Aliases:

<span class="m">7</span>.46.168.192.in-addr.arpa domain name pointer ns1.linuxpanda.tech.
<span class="m">7</span>.46.168.192.in-addr.arpa domain name pointer www.linuxpanda.tech.

<span class="c1"># 另一个主机测试</span>
<span class="o">[</span>root@101 ~<span class="o">]</span><span class="c1"># dig -t axfr linuxpanda.tech @192.168.46.7                         # 完全区域传输，走的tcp协议，普通查询走的udp协议</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; -t axfr linuxpanda.tech @192.168.46.7
<span class="p">;;</span> global options: +cmd
linuxpanda.tech.    <span class="m">86400</span>   IN      SOA     ns1.linuxpanda.tech. nsadmin.linuxpanda.tech. <span class="m">0</span> <span class="m">86400</span> <span class="m">3600</span> <span class="m">604800</span> <span class="m">10800</span>
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns1.linuxpanda.tech.
ns1.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7
www.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7
linuxpanda.tech.    <span class="m">86400</span>   IN      SOA     ns1.linuxpanda.tech. nsadmin.linuxpanda.tech. <span class="m">0</span> <span class="m">86400</span> <span class="m">3600</span> <span class="m">604800</span> <span class="m">10800</span>
<span class="p">;;</span> Query time: <span class="m">1</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.46.7#53<span class="o">(</span><span class="m">192</span>.168.46.7<span class="o">)</span>
<span class="p">;;</span> WHEN: Thu Jan <span class="m">18</span> <span class="m">00</span>:44:18 EST <span class="m">2018</span>
<span class="p">;;</span> XFR size: <span class="m">5</span> records <span class="o">(</span>messages <span class="m">1</span>, bytes <span class="m">167</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id14">
<h2>8.1.7. 主从服务器<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h2>
<p>上面我们在192.168.46.7的服务器上面配置了dns，下面以192.168.46.101作为7的从dns来完成dns的主从配置</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">在选择主从服务器的时候，注意服务器版本问题，不同版本安装的bind可能会导致不同情况，无法同步问题。</p>
</div>
<div class="section" id="id15">
<h3>8.1.7.1. 编辑配置文件<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># vim /etc/named.conf                 # 编辑主配置文件</span>
<span class="c1">#注释以下行，使用//注释</span>
//      listen-on port <span class="m">53</span> <span class="o">{</span> <span class="m">127</span>.0.0.1<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
//      allow-query     <span class="o">{</span> localhost<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
<span class="c1"># 修改下面2项为no</span>
    dnssec-enable no<span class="p">;</span>
    dnssec-validation no<span class="p">;</span>
<span class="c1"># 添加如下配置</span>
allow-transfer <span class="o">{</span> <span class="m">192</span>.168.46.101<span class="p">;</span><span class="o">}</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h3>8.1.7.2. 添加区域文件<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 主服务器修改</span>

<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cat linuxpanda.tech.zone           # 编辑区域文件</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cat linuxpanda.tech.zone           # 检查区域文件，确保有从服务器的ns记录和对应的a记录</span>
<span class="nv">$TTL</span> 1D
@   IN SOA  ns1 nsadmin <span class="o">(</span>
                    <span class="m">0</span>       <span class="p">;</span> serial
                    1D      <span class="p">;</span> refresh
                    1H      <span class="p">;</span> retry
                    1W      <span class="p">;</span> expire
                    3H <span class="o">)</span>    <span class="p">;</span> minimum
    NS      ns1
    NS      ns2
ns1 A       <span class="m">192</span>.168.46.7
ns2     A       <span class="m">192</span>.168.46.101
www     A       <span class="m">192</span>.168.46.7

<span class="c1"># 从服务器修改</span>
<span class="o">[</span>root@101 ~<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones      # 从服务器添加区域，设置与主服务器的关联配置</span>
zone <span class="s2">&quot;linuxpanda.tech&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> slave<span class="p">;</span>
        master <span class="o">{</span> <span class="m">192</span>.168.46.7<span class="p">;</span><span class="o">}</span>
        file <span class="s2">&quot;slaves/linuxpanda.tech.slave.zone&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">从服务器的必须要在主dns添加记录的。</p>
</div>
</div>
<div class="section" id="id17">
<h3>8.1.7.3. 重启服务<a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@101 named<span class="o">]</span><span class="c1"># systemctl restart named               # 重启服务</span>
<span class="o">[</span>root@101 named<span class="o">]</span><span class="c1"># ll slaves/                            # 发现文件已经同步过来了。</span>
total <span class="m">4</span>
-rw-r--r--. <span class="m">1</span> named named <span class="m">283</span> Jan <span class="m">18</span> <span class="m">01</span>:36 linuxpanda.tech.slave.zone
<span class="o">[</span>root@101 named<span class="o">]</span><span class="c1"># file slaves/linuxpanda.tech.slave.zone</span>
slaves/linuxpanda.tech.slave.zone: data
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">centos7环境下从文件都是data的了，不再是文本了。</p>
</div>
</div>
<div class="section" id="id18">
<h3>8.1.7.4. 测试<a class="headerlink" href="#id18" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@101 named<span class="o">]</span><span class="c1"># dig -t axfr linuxpanda.tech  @192.168.46.101          # 测试下，发现不对啊。</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; -t axfr linuxpanda.tech @192.168.46.101
<span class="p">;;</span> global options: +cmd
linuxpanda.tech.    <span class="m">86400</span>   IN      SOA     ns1.linuxpanda.tech. nsadmin.linuxpanda.tech. <span class="m">0</span> <span class="m">86400</span> <span class="m">3600</span> <span class="m">604800</span> <span class="m">10800</span>
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns1.linuxpanda.tech.
ns1.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7
www.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7
linuxpanda.tech.    <span class="m">86400</span>   IN      SOA     ns1.linuxpanda.tech. nsadmin.linuxpanda.tech. <span class="m">0</span> <span class="m">86400</span> <span class="m">3600</span> <span class="m">604800</span> <span class="m">10800</span>
<span class="p">;;</span> Query time: <span class="m">1</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.46.101#53<span class="o">(</span><span class="m">192</span>.168.46.101<span class="o">)</span>
<span class="p">;;</span> WHEN: Thu Jan <span class="m">18</span> <span class="m">01</span>:44:01 EST <span class="m">2018</span>
<span class="p">;;</span> XFR size: <span class="m">5</span> records <span class="o">(</span>messages <span class="m">1</span>, bytes <span class="m">167</span><span class="o">)</span>

<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># rndc reload                                             #    这个在主服务器上执行下。</span>
<span class="o">[</span>root@101 named<span class="o">]</span><span class="c1"># rndc reload                                           #    这个在从服务器上执行</span>
server reload successful
<span class="o">[</span>root@101 named<span class="o">]</span><span class="c1"># dig -t axfr linuxpanda.tech  @192.168.46.101          # 再次测试</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; -t axfr linuxpanda.tech @192.168.46.101
<span class="p">;;</span> global options: +cmd
linuxpanda.tech.    <span class="m">86400</span>   IN      SOA     ns1.linuxpanda.tech. nsadmin.linuxpanda.tech. <span class="m">1</span> <span class="m">86400</span> <span class="m">3600</span> <span class="m">604800</span> <span class="m">10800</span>
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns1.linuxpanda.tech.
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns2.linuxpanda.tech.
ns1.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7
ns2.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.101
www.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7
linuxpanda.tech.    <span class="m">86400</span>   IN      SOA     ns1.linuxpanda.tech. nsadmin.linuxpanda.tech. <span class="m">1</span> <span class="m">86400</span> <span class="m">3600</span> <span class="m">604800</span> <span class="m">10800</span>
<span class="p">;;</span> Query time: <span class="m">0</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.46.101#53<span class="o">(</span><span class="m">192</span>.168.46.101<span class="o">)</span>
<span class="p">;;</span> WHEN: Thu Jan <span class="m">18</span> <span class="m">01</span>:45:02 EST <span class="m">2018</span>
<span class="p">;;</span> XFR size: <span class="m">7</span> records <span class="o">(</span>messages <span class="m">1</span>, bytes <span class="m">201</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id19">
<h3>8.1.7.5. 进一步测试<a class="headerlink" href="#id19" title="永久链接至标题">¶</a></h3>
<p>主服务器修改下</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># !vim</span>
vim linuxpanda.tech.zone
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cat linuxpanda.tech.zone        # 添加了blog记录并修改了序号为2（原有基础上+1），这个必须比原有的数值大，才有效。</span>
<span class="nv">$TTL</span> 1D
@       IN SOA  ns1 nsadmin <span class="o">(</span>
                    <span class="m">2</span>   <span class="p">;</span> serial
                    1D  <span class="p">;</span> refresh
                    1H  <span class="p">;</span> retry
                    1W  <span class="p">;</span> expire
                    3H <span class="o">)</span>        <span class="p">;</span> minimum
    NS  ns1
    NS      ns2
ns1     A       <span class="m">192</span>.168.46.7
ns2     A       <span class="m">192</span>.168.46.101
www     A       <span class="m">192</span>.168.46.7
blog    A       <span class="m">192</span>.168.46.101
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># rndc reload                     # 重新加载配置文件</span>
server reload successful
</pre></div>
</div>
<p>从服务器测试</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@101 named<span class="o">]</span><span class="c1"># dig -t axfr linuxpanda.tech  @192.168.46.101            # 查询测试，发现我们在主dns上的blog记录已经添加进来了</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; -t axfr linuxpanda.tech @192.168.46.101
<span class="p">;;</span> global options: +cmd
linuxpanda.tech.    <span class="m">86400</span>   IN      SOA     ns1.linuxpanda.tech. nsadmin.linuxpanda.tech. <span class="m">2</span> <span class="m">86400</span> <span class="m">3600</span> <span class="m">604800</span> <span class="m">10800</span>
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns1.linuxpanda.tech.
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns2.linuxpanda.tech.
blog.linuxpanda.tech.       <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.101
ns1.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7
ns2.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.101
www.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7
linuxpanda.tech.    <span class="m">86400</span>   IN      SOA     ns1.linuxpanda.tech. nsadmin.linuxpanda.tech. <span class="m">2</span> <span class="m">86400</span> <span class="m">3600</span> <span class="m">604800</span> <span class="m">10800</span>
<span class="p">;;</span> Query time: <span class="m">1</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.46.101#53<span class="o">(</span><span class="m">192</span>.168.46.101<span class="o">)</span>
<span class="p">;;</span> WHEN: Thu Jan <span class="m">18</span> <span class="m">01</span>:50:21 EST <span class="m">2018</span>
<span class="p">;;</span> XFR size: <span class="m">8</span> records <span class="o">(</span>messages <span class="m">1</span>, bytes <span class="m">222</span><span class="o">)</span>



<span class="o">[</span>root@101 named<span class="o">]</span><span class="c1"># cat /var/log/messages                        # 查看下日志关于named的信息</span>
--------------------------省去一部分-----------------------------------------------------------
Jan <span class="m">18</span> <span class="m">01</span>:48:49 station named<span class="o">[</span><span class="m">7809</span><span class="o">]</span>: client <span class="m">192</span>.168.46.7#43665: received notify <span class="k">for</span> zone <span class="s1">&#39;linuxpanda.tech&#39;</span>
Jan <span class="m">18</span> <span class="m">01</span>:48:49 station named<span class="o">[</span><span class="m">7809</span><span class="o">]</span>: zone linuxpanda.tech/IN: Transfer started.
Jan <span class="m">18</span> <span class="m">01</span>:48:49 station named<span class="o">[</span><span class="m">7809</span><span class="o">]</span>: transfer of <span class="s1">&#39;linuxpanda.tech/IN&#39;</span> from <span class="m">192</span>.168.46.7#53: connected using <span class="m">192</span>.168.46.101#48087
Jan <span class="m">18</span> <span class="m">01</span>:48:49 station named<span class="o">[</span><span class="m">7809</span><span class="o">]</span>: zone linuxpanda.tech/IN: transferred serial <span class="m">2</span>
Jan <span class="m">18</span> <span class="m">01</span>:48:49 station named<span class="o">[</span><span class="m">7809</span><span class="o">]</span>: transfer of <span class="s1">&#39;linuxpanda.tech/IN&#39;</span> from <span class="m">192</span>.168.46.7#53: Transfer completed: <span class="m">1</span> messages, <span class="m">8</span> records, <span class="m">222</span> bytes, <span class="m">0</span>.010 secs <span class="o">(</span><span class="m">22200</span> bytes/sec<span class="o">)</span>
Jan <span class="m">18</span> <span class="m">01</span>:48:49 station named<span class="o">[</span><span class="m">7809</span><span class="o">]</span>: zone linuxpanda.tech/IN: sending notifies <span class="o">(</span>serial <span class="m">2</span><span class="o">)</span>
Jan <span class="m">18</span> <span class="m">01</span>:49:23 station named<span class="o">[</span><span class="m">7809</span><span class="o">]</span>: client <span class="m">192</span>.168.46.101#59454 <span class="o">(</span>linuxpanda.tech<span class="o">)</span>: transfer of <span class="s1">&#39;linuxpanda.tech/IN&#39;</span>: AXFR started
Jan <span class="m">18</span> <span class="m">01</span>:49:23 station named<span class="o">[</span><span class="m">7809</span><span class="o">]</span>: client <span class="m">192</span>.168.46.101#59454 <span class="o">(</span>linuxpanda.tech<span class="o">)</span>: transfer of <span class="s1">&#39;linuxpanda.tech/IN&#39;</span>: AXFR ended
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">如果从DNS服务器没法同步，请检查服务器配置和2个服务器的日志信息</p>
</div>
</div>
</div>
<div class="section" id="id20">
<h2>8.1.8. 允许远程动态更新<a class="headerlink" href="#id20" title="永久链接至标题">¶</a></h2>
<div class="section" id="id21">
<h3>8.1.8.1. 主服务器修改<a class="headerlink" href="#id21" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones       # 添加允许更新</span>
zone <span class="s2">&quot;linuxpanda.tech&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> master<span class="p">;</span>
        file <span class="s2">&quot;linuxpanda.tech.zone&quot;</span><span class="p">;</span>
        allow-update <span class="o">{</span> <span class="m">192</span>.168.46.101<span class="p">;</span><span class="o">}</span> <span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># chmod g+w /var/named/                # 给named添加目录写权限，</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># systemctl restart named              # 重启服务</span>
</pre></div>
</div>
</div>
<div class="section" id="id22">
<h3>8.1.8.2. 从服务器来更新<a class="headerlink" href="#id22" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@101 named<span class="o">]</span><span class="c1"># nsupdate                           # 这个命令是交互的</span>
&gt; server <span class="m">192</span>.168.46.7
&gt; zone linuxpanda.tech
&gt; update add ftp.linuxpanda.tech. <span class="m">9000</span> IN A <span class="m">192</span>.168.46.101
&gt; send
&gt; quit
</pre></div>
</div>
</div>
<div class="section" id="id23">
<h3>8.1.8.3. 主服务器测试<a class="headerlink" href="#id23" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># ll -t                                                    # 查看文件</span>
total <span class="m">28</span>
-rw-r--r--. <span class="m">1</span> named named  <span class="m">757</span> Jan <span class="m">18</span> <span class="m">16</span>:02 linuxpanda.tech.zone.jnl
-rw-r-----. <span class="m">1</span> root  named  <span class="m">256</span> Jan <span class="m">18</span> <span class="m">14</span>:47 linuxpanda.tech.zone
-rw-r-----. <span class="m">1</span> root  named  <span class="m">258</span> Jan <span class="m">18</span> <span class="m">12</span>:32 <span class="m">192</span>.168.46.zone
drwxrwx---. <span class="m">2</span> named named   <span class="m">31</span> Jan <span class="m">17</span> <span class="m">20</span>:43 dynamic
drwxrwx---. <span class="m">2</span> named named   <span class="m">23</span> Jan <span class="m">17</span> <span class="m">20</span>:23 data
drwxrwx---. <span class="m">2</span> named named    <span class="m">6</span> Aug  <span class="m">4</span> <span class="m">16</span>:13 slaves
-rw-r-----. <span class="m">1</span> root  named <span class="m">2281</span> May <span class="m">22</span>  <span class="m">2017</span> named.ca
-rw-r-----. <span class="m">1</span> root  named  <span class="m">152</span> Dec <span class="m">15</span>  <span class="m">2009</span> named.empty
-rw-r-----. <span class="m">1</span> root  named  <span class="m">168</span> Dec <span class="m">15</span>  <span class="m">2009</span> named.loopback
-rw-r-----. <span class="m">1</span> root  named  <span class="m">152</span> Jun <span class="m">21</span>  <span class="m">2007</span> named.localhost
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cat linuxpanda.tech.zone.jnl                            # 查看下这个是啥</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># dig -t axfr linuxpanda.tech. @192.168.46.7 |grep ftp    # 查看添加的记录</span>
ftp.linuxpanda.tech.        <span class="m">9000</span>    IN      A       <span class="m">192</span>.168.46.101
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">动态更新后，从服务器也会自动更新的，但是序号是没有增加的。</p>
</div>
</div>
</div>
<div class="section" id="id24">
<h2>8.1.9. 启用查询日志记录<a class="headerlink" href="#id24" title="永久链接至标题">¶</a></h2>
<p>这个启用dns查询日志记录功能， 不建议开启的（大量日志操作），只有在调试dns配置的时候开启。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># rndc status                             # 查看dns状态信息</span>
version: <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;id:8f9657aa&gt;
CPUs found: <span class="m">1</span>
worker threads: <span class="m">1</span>
UDP listeners per interface: <span class="m">1</span>
number of zones: <span class="m">103</span>
debug level: <span class="m">0</span>
xfers running: <span class="m">0</span>
xfers deferred: <span class="m">0</span>
soa queries in progress: <span class="m">0</span>
query logging is OFF
recursive clients: <span class="m">0</span>/0/1000
tcp clients: <span class="m">0</span>/100
server is up and running
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># rndc querylog                           # 日志切换命令，off-&gt;on,on-&gt;off</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># rndc status |grep logging               # 查看</span>
query logging is ON
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># rndc querylog                           # 日志切换</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># rndc status |grep logging               # 查看</span>
query logging is OFF
</pre></div>
</div>
</div>
<div class="section" id="id25">
<h2>8.1.10. 子域配置<a class="headerlink" href="#id25" title="永久链接至标题">¶</a></h2>
<p>配置子域需要的服务器也比较多。 简单规划下。</p>
<ul class="simple">
<li>192.168.46.7 : linuxpanda.tech</li>
<li>192.168.46.101 : henan.linuxpanda.tech</li>
<li>192.168.46.102 : zhengzhou.henan.linuxpanda.tech</li>
</ul>
<p>我这里linuxpanda.tech 就认为是我自己的顶级域。 henan就是二级域，zhengzhou就是三级域。</p>
<div class="section" id="id26">
<h3>8.1.10.1. 环境配置<a class="headerlink" href="#id26" title="永久链接至标题">¶</a></h3>
<p>前面我使用了192.168.46.7和192.168.46.101两个机器，这个实验，我就重新安装下bind来覆盖原有设置了。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 192.168.46.7 机器上操作</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># rm -rf /etc/named*</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># rm -rf /var/named</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># yum reinstall bind</span>

<span class="c1"># 192.168.46.101 机器上操作</span>
<span class="o">[</span>root@101 named<span class="o">]</span><span class="c1"># rm -rf /etc/named*</span>
<span class="o">[</span>root@102 named<span class="o">]</span><span class="c1"># rm -rf /var/named</span>
<span class="o">[</span>root@102 named<span class="o">]</span><span class="c1"># yum reinstall bind</span>
</pre></div>
</div>
</div>
<div class="section" id="id27">
<h3>8.1.10.2. 顶级域配置<a class="headerlink" href="#id27" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># vim /etc/named.conf</span>
<span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># vim /etc/named.conf</span>
<span class="c1">#注释以下行，使用//注释</span>
//      listen-on port <span class="m">53</span> <span class="o">{</span> <span class="m">127</span>.0.0.1<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
//      allow-query     <span class="o">{</span> localhost<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
<span class="c1"># 修改下面2项为no</span>
dnssec-enable no<span class="p">;</span>
dnssec-validation no<span class="p">;</span>

<span class="c1"># 添加如下配置</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones</span>
zone <span class="s2">&quot;linuxpanda.tech&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> master<span class="p">;</span>
        file <span class="s2">&quot;linuxpanda.tech.zone&quot;</span><span class="p">;</span>
<span class="o">}</span>
<span class="p">;</span>

<span class="c1"># 添加区域文件</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cd /var/named/</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># ls</span>
data  dynamic  named.ca  named.empty  named.localhost  named.loopback  slaves
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cp named.localhost  linuxpanda.tech.zone -p             # 保留权限</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># vim linuxpanda.tech.zone                                # 添加区域</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cat linuxpanda.tech.zone                                # 检查区域</span>
<span class="nv">$TTL</span> 1D
@       IN SOA  ns1 nsadmin <span class="o">(</span>
                                        <span class="m">0</span>       <span class="p">;</span> serial
                                        1D      <span class="p">;</span> refresh
                                        1H      <span class="p">;</span> retry
                                        1W      <span class="p">;</span> expire
                                        3H <span class="o">)</span>    <span class="p">;</span> minimum
        NS      ns1
henan   NS      ns2
ns1     A       <span class="m">192</span>.168.46.7
ns2   A         <span class="m">192</span>.168.46.101
www     A       <span class="m">192</span>.168.46.7

<span class="c1"># 配置测试</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># named-checkconf                                         # 检查配置</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># named-checkzone  linuxpanda.tech linuxpanda.tech.zone   # 检查区域</span>
<span class="c1"># 启动服务</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># systemctl restart named                                 # 重启服务</span>
</pre></div>
</div>
</div>
<div class="section" id="id28">
<h3>8.1.10.3. 一级域配置<a class="headerlink" href="#id28" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># vim /etc/named.conf                                     # 编辑主配置</span>
<span class="c1">#注释以下行，使用//注释</span>
//      listen-on port <span class="m">53</span> <span class="o">{</span> <span class="m">127</span>.0.0.1<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
//      allow-query     <span class="o">{</span> localhost<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
<span class="c1"># 修改下面2项为no</span>
dnssec-enable no<span class="p">;</span>
dnssec-validation no<span class="p">;</span>

<span class="c1"># 添加如下配置</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones</span>
zone <span class="s2">&quot;henan.linuxpanda.tech&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> master<span class="p">;</span>
        file <span class="s2">&quot;henan.linuxpanda.tech.zone&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>

<span class="c1"># 添加区域文件</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cd /var/named/</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># ls</span>
data  dynamic  named.ca  named.empty  named.localhost  named.loopback  slaves
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cp -p named.localhost  henan.linuxpanda.tech.zone   # 保留权限</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># vim henan.linuxpanda.tech.zone                      # 编辑区域文件</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cat henan.linuxpanda.tech.zone                      # 检查区域文件</span>
<span class="nv">$TTL</span> 1D
@       IN SOA  ns1 nsadmin <span class="o">(</span>
                                        <span class="m">0</span>       <span class="p">;</span> serial
                                        1D      <span class="p">;</span> refresh
                                        1H      <span class="p">;</span> retry
                                        1W      <span class="p">;</span> expire
                                        3H <span class="o">)</span>    <span class="p">;</span> minimum
                NS       ns1
zhengzhou       NS       ns2
ns1     A       <span class="m">192</span>.168.46.101
ns2  A   <span class="m">192</span>.168.46.102
www        A    <span class="m">192</span>.168.46.101

<span class="c1"># 配置测试</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># named-checkconf                                                      # 检查主配置文件</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># named-checkzone  henan.linuxpanda.tech henan.linuxpanda.tech.zone    # 检查区域文件</span>
<span class="c1"># 启动服务</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># systemctl restart named                                              # 重启服务</span>
</pre></div>
</div>
</div>
<div class="section" id="id29">
<h3>8.1.10.4. 二级域配置<a class="headerlink" href="#id29" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># vim /etc/named.conf                             # 编辑主配置文件</span>
<span class="c1">#注释以下行，使用//注释</span>
//      listen-on port <span class="m">53</span> <span class="o">{</span> <span class="m">127</span>.0.0.1<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
//      allow-query     <span class="o">{</span> localhost<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
<span class="c1"># 修改下面2项为no</span>
dnssec-enable no<span class="p">;</span>
dnssec-validation no<span class="p">;</span>

<span class="c1"># 添加如下配置</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones</span>
zone <span class="s2">&quot;zhengzhou.henan.linuxpanda.tech&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> master<span class="p">;</span>
        file <span class="s2">&quot;zhengzhou.henan.linuxpanda.tech.zone&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>

<span class="c1"># 添加区域文件</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cd /var/named/</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># ls</span>
data  dynamic  named.ca  named.empty  named.localhost  named.loopback  slaves
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cp -p named.localhost  linuxpanda.tech.zone         # 保留权限</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># vim zhengzhou.henan.linuxpanda.tech.zone            # 编辑配置文件</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># cat zhengzhou.henan.linuxpanda.tech.zone            # 检查配置文件</span>
<span class="nv">$TTL</span> 1D
@   IN SOA  ns1 nsadmin <span class="o">(</span>
                    <span class="m">0</span>           <span class="p">;</span> serial
                    1D          <span class="p">;</span> refresh
                    1H          <span class="p">;</span> retry
                    1W          <span class="p">;</span> expire
                    3H <span class="o">)</span>    <span class="p">;</span> minimum
    NS       ns1
    NS       zhengzhou
ns1 A       <span class="m">192</span>.168.46.101
zhengzhou  A   <span class="m">192</span>.168.46.102
www        A    <span class="m">192</span>.168.46.101
web     CNAME   www

<span class="c1"># 配置测试</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># named-checkconf                                                                       # 配置文件检查</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># named-checkzone  zhengzhou.henan.linuxpanda.tech zhengzhou.henan.linuxpanda.tech.zone # 区域文件检查</span>
<span class="c1"># 启动服务</span>
<span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># systemctl restart named                                                               # 重启</span>
</pre></div>
</div>
<p>测试下</p>
<p>在192.168.46.7上面验证下：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@7 named<span class="o">]</span><span class="c1"># host web.zhengzhou.henan.linuxpanda.tech 192.168.46.7                               # 测试</span>
Using domain server:
Name: <span class="m">192</span>.168.46.7
Address: <span class="m">192</span>.168.46.7#53
Aliases:

web.zhengzhou.henan.linuxpanda.tech is an <span class="nb">alias</span> <span class="k">for</span> www.zhengzhou.henan.linuxpanda.tech.
www.zhengzhou.henan.linuxpanda.tech has address <span class="m">192</span>.168.46.102
</pre></div>
</div>
</div>
</div>
<div class="section" id="id30">
<h2>8.1.11. 转发服务器<a class="headerlink" href="#id30" title="永久链接至标题">¶</a></h2>
<p>转发分为2种：</p>
<ul class="simple">
<li>全局转发： 全局配置文件设置</li>
<li>特定域转发： 特定域内配置</li>
</ul>
<p>转发类型2种：</p>
<ul class="simple">
<li>first： 转发给特定服务器，如果他没有就在找自己找根。</li>
<li>only: 抓发给特定服务器，如果他找不到自己不继续找。</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">请关闭dnssec功能。</p>
</div>
<p>我这里接着上面的实验基础上的， 上面我做了3级别的域 linuxpanda.tech ,henan.linuxpanda.tech ,zhengzhou.henan.linuxpanda.tech</p>
<p>给henan.linxupanda.tech配置特定域转发</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@101 ~<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones              # 编辑主配置文件</span>
<span class="c1"># 添加如何内容</span>
zone <span class="s2">&quot;linuxpanda.tech&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> forward<span class="p">;</span>
        forward first<span class="p">;</span>
        forwarders <span class="o">{</span> <span class="m">192</span>.168.46.7<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
</pre></div>
</div>
<p>给zhengzhou.henan.linxupanda.tech配置特定域转发</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@102 ~<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones            # 编辑主配置文件</span>
<span class="c1"># 添加如何内容</span>
zone <span class="s2">&quot;henan.linuxpanda.tech&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> forward<span class="p">;</span>
        forward first<span class="p">;</span>
        forwarders <span class="o">{</span> <span class="m">192</span>.168.46.101<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
zone <span class="s2">&quot;linuxpanda.tech&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> forward<span class="p">;</span>
        forward first<span class="p">;</span>
        forwarders <span class="o">{</span> <span class="m">192</span>.168.46.101<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">修改配置文件后需要重启服务或者使用rndc reload重新加载配置文件。</p>
</div>
<p>测试</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 我们先测试我内部的服务器的dns主机</span>

<span class="o">[</span>root@102 ~<span class="o">]</span>$ host ns2.linuxpanda.tech <span class="m">192</span>.168.46.102           <span class="c1"># 测试192.168.46.7机器上面有的服务器。</span>
Using domain server:
Name: <span class="m">192</span>.168.46.102
Address: <span class="m">192</span>.168.46.102#53
Aliases:

ns2.linuxpanda.tech has address <span class="m">192</span>.168.46.101
<span class="c1"># 上面可以看到，我们的都给转发了。</span>
<span class="c1"># 下面测试一个内部dns没有的主机wwwxx,结构跑到互联网上给我们解析了，如果forward 设置only，就不会在去解析了。</span>
<span class="o">[</span>root@102 ~<span class="o">]</span>$ host wwwxx.linuxpanda.tech                        <span class="c1"># 测试一个192.168.46.7机器上面没有的服务器</span>
wwwxx.linuxpanda.tech has address <span class="m">39</span>.106.157.220
<span class="c1"># 这个ip就是我买的云服务器ip，域名解析到这个ip了。</span>
</pre></div>
</div>
</div>
<div class="section" id="view">
<h2>8.1.12. view<a class="headerlink" href="#view" title="永久链接至标题">¶</a></h2>
<div class="section" id="acl">
<h3>8.1.12.1. 定义acl<a class="headerlink" href="#acl" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># vim /etc/named.conf</span>
acl netdianxin <span class="o">{</span> <span class="m">192</span>.168.1.0/24<span class="p">;</span><span class="o">}</span><span class="p">;</span>
acl netyidong <span class="o">{</span> <span class="m">192</span>.168.46.0/24<span class="p">;</span><span class="o">}</span><span class="p">;</span>
acl netother <span class="o">{</span> any<span class="p">;</span><span class="o">}</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id31">
<h3>8.1.12.2. 迁移根区域<a class="headerlink" href="#id31" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># !vim /etc/named.conf</span>
<span class="c1"># 删除下面的4行数据</span>
zone <span class="s2">&quot;.&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> hint<span class="p">;</span>
        file <span class="s2">&quot;named.ca&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
<span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones</span>
<span class="c1"># 添加上面删除的4行数据</span>
zone <span class="s2">&quot;.&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> hint<span class="p">;</span>
        file <span class="s2">&quot;named.ca&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id32">
<h3>8.1.12.3. 配置view<a class="headerlink" href="#id32" title="永久链接至标题">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[root@centos7 ~]# cat /etc/named.conf
//
// named.conf
//
// Provided by Red Hat bind package to configure the ISC BIND named(8) DNS
// server as a caching only nameserver (as a localhost DNS resolver only).
//
// See /usr/share/doc/bind*/sample/ for example named configuration files.
//
// See the BIND Administrator&#39;s Reference Manual (ARM) for details about the
// configuration located in /usr/share/doc/bind-{version}/Bv9ARM.html
acl netdianxin { 192.168.46.0/24;};
acl netyidong { 192.168.1.0/24;};
acl netother { any;};
options {
//  listen-on port 53 { 127.0.0.1; };
    listen-on-v6 port 53 { ::1; };
    directory       &quot;/var/named&quot;;
    dump-file       &quot;/var/named/data/cache_dump.db&quot;;
    statistics-file &quot;/var/named/data/named_stats.txt&quot;;
    memstatistics-file &quot;/var/named/data/named_mem_stats.txt&quot;;
//  allow-query     { localhost; };

    /*
    - If you are building an AUTHORITATIVE DNS server, do NOT enable recursion.
    - If you are building a RECURSIVE (caching) DNS server, you need to enable
    recursion.
    - If your recursive DNS server has a public IP address, you MUST enable access
    control to limit queries to your legitimate users. Failing to do so will
    cause your server to become part of large scale DNS amplification
    attacks. Implementing BCP38 within your network would greatly
    reduce such attack surface
    */
    recursion yes;

    dnssec-enable no;
    dnssec-validation no;

    /* Path to ISC DLV key */
    bindkeys-file &quot;/etc/named.iscdlv.key&quot;;

    managed-keys-directory &quot;/var/named/dynamic&quot;;

    pid-file &quot;/run/named/named.pid&quot;;
    session-keyfile &quot;/run/named/session.key&quot;;
};

logging {
        channel default_debug {
                file &quot;data/named.run&quot;;
                severity dynamic;
        };
};

view viewdianxin {
    match-clients {netdianxin;};
    zone &quot;linuxpanda.tech&quot; {
        type master;
        file &quot;linuxpanda.tech.netdianxin.zone&quot;;
    };
    include &quot;/etc/named.rfc1912.zones&quot;;

};
view viewyidong{
    match-clients {netyidong;};
    zone &quot;linuxpanda.tech&quot; {
        type master;
        file &quot;linuxpanda.tech.netyidong.zone&quot;;
    };
    include &quot;/etc/named.rfc1912.zones&quot;;

};

include &quot;/etc/named.root.key&quot;;
</pre></div>
</div>
</div>
<div class="section" id="id33">
<h3>8.1.12.4. 添加文件<a class="headerlink" href="#id33" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos7 named<span class="o">]</span><span class="c1"># mv  linuxpanda.tech.zone linuxpanda.tech.netdianxin.zone</span>
<span class="o">[</span>root@centos7 named<span class="o">]</span><span class="c1"># cp linuxpanda.tech.netdianxin.zone linuxpanda.tech.netyidong.zone</span>
<span class="o">[</span>root@centos7 named<span class="o">]</span><span class="c1"># vim linuxpanda.tech.netdianxin.zone</span>
<span class="o">[</span>root@centos7 named<span class="o">]</span><span class="c1"># cp linuxpanda.tech.netdianxin.zone linuxpanda.tech.netyidong.zone</span>
cp: overwrite ‘linuxpanda.tech.netyidong.zone’? y
<span class="o">[</span>root@centos7 named<span class="o">]</span><span class="c1"># vim linuxpanda.tech.netyidong.zone</span>
<span class="o">[</span>root@centos7 named<span class="o">]</span><span class="c1"># cat linuxpanda.tech.netdianxin.zone</span>
<span class="nv">$TTL</span> 1D
@   IN SOA  ns1 nsadmin <span class="o">(</span>
                    <span class="m">0</span>       <span class="p">;</span> serial
                    1D      <span class="p">;</span> refresh
                    1H      <span class="p">;</span> retry
                    1W      <span class="p">;</span> expire
                    3H <span class="o">)</span>    <span class="p">;</span> minimum
    NS      ns1
ns1 A       <span class="m">192</span>.168.46.7
www A       <span class="m">192</span>.168.46.7
<span class="o">[</span>root@centos7 named<span class="o">]</span><span class="c1"># cat linuxpanda.tech.netyidong.zone</span>
<span class="nv">$TTL</span> 1D
@   IN SOA  ns1 nsadmin <span class="o">(</span>
                    <span class="m">0</span>       <span class="p">;</span> serial
                    1D      <span class="p">;</span> refresh
                    1H      <span class="p">;</span> retry
                    1W      <span class="p">;</span> expire
                    3H <span class="o">)</span>    <span class="p">;</span> minimum
    NS      ns1
ns1 A       <span class="m">192</span>.168.1.103
www A       <span class="m">192</span>.168.1.103
</pre></div>
</div>
</div>
<div class="section" id="id34">
<h3>8.1.12.5. 验证<a class="headerlink" href="#id34" title="永久链接至标题">¶</a></h3>
<p>第一个网段测试</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@102 ~<span class="o">]</span>$ dig www.linuxpanda.tech @192.168.46.7

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-51.el7_4.1 &lt;&lt;&gt;&gt; www.linuxpanda.tech @192.168.46.7
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">33006</span>
<span class="p">;;</span> flags: qr aa rd ra<span class="p">;</span> QUERY: <span class="m">1</span>, ANSWER: <span class="m">1</span>, AUTHORITY: <span class="m">1</span>, ADDITIONAL: <span class="m">2</span>

<span class="p">;;</span> OPT PSEUDOSECTION:
<span class="p">;</span> EDNS: version: <span class="m">0</span>, flags:<span class="p">;</span> udp: <span class="m">4096</span>
<span class="p">;;</span> QUESTION SECTION:
<span class="p">;</span>www.linuxpanda.tech.               IN      A

<span class="p">;;</span> ANSWER SECTION:
www.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7

<span class="p">;;</span> AUTHORITY SECTION:
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns1.linuxpanda.tech.

<span class="p">;;</span> ADDITIONAL SECTION:
ns1.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.7

<span class="p">;;</span> Query time: <span class="m">0</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.46.7#53<span class="o">(</span><span class="m">192</span>.168.46.7<span class="o">)</span>
<span class="p">;;</span> WHEN: Sat Jan <span class="m">20</span> <span class="m">17</span>:13:13 CST <span class="m">2018</span>
<span class="p">;;</span> MSG SIZE  rcvd: <span class="m">98</span>
</pre></div>
</div>
<p>第二个网段测试</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@101 ~<span class="o">]</span><span class="c1"># dig www.linuxpanda.tech @192.168.1.103</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; www.linuxpanda.tech @192.168.1.103
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">158</span>
<span class="p">;;</span> flags: qr aa rd ra<span class="p">;</span> QUERY: <span class="m">1</span>, ANSWER: <span class="m">1</span>, AUTHORITY: <span class="m">1</span>, ADDITIONAL: <span class="m">2</span>

<span class="p">;;</span> OPT PSEUDOSECTION:
<span class="p">;</span> EDNS: version: <span class="m">0</span>, flags:<span class="p">;</span> udp: <span class="m">4096</span>
<span class="p">;;</span> QUESTION SECTION:
<span class="p">;</span>www.linuxpanda.tech.               IN      A

<span class="p">;;</span> ANSWER SECTION:
www.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.1.103

<span class="p">;;</span> AUTHORITY SECTION:
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns1.linuxpanda.tech.

<span class="p">;;</span> ADDITIONAL SECTION:
ns1.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.1.103

<span class="p">;;</span> Query time: <span class="m">0</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.1.103#53<span class="o">(</span><span class="m">192</span>.168.1.103<span class="o">)</span>
<span class="p">;;</span> WHEN: Sat Jan <span class="m">20</span> <span class="m">04</span>:13:29 EST <span class="m">2018</span>
<span class="p">;;</span> MSG SIZE  rcvd: <span class="m">98</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id35">
<h2>8.1.13. 互联网dns实现<a class="headerlink" href="#id35" title="永久链接至标题">¶</a></h2>
<div class="section" id="id36">
<h3>8.1.13.1. 绘制架构图<a class="headerlink" href="#id36" title="永久链接至标题">¶</a></h3>
<p>这个实现情况布局比较复杂，需要先构思一个草图，简单如下：</p>
<img alt="images/dns/互联网dns.png" src="images/dns/互联网dns.png" />
</div>
<div class="section" id="id37">
<h3>8.1.13.2. 服务器规划<a class="headerlink" href="#id37" title="永久链接至标题">¶</a></h3>
<p>为了方便后续配置简单设置下主机名如下</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>主根： root1
从根： root2
tech域： tech
com域：   com
linuxpanda: linuxpanda
www1:www1
www2:www2
运营商：dianxin
client:client
</pre></div>
</div>
</div>
<div class="section" id="ip">
<h3>8.1.13.3. ip配置<a class="headerlink" href="#ip" title="永久链接至标题">¶</a></h3>
<p>根据上面的配置设置ip信息。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#  nmcli con del ens33 ;</span>
<span class="c1">#  nmcli con add con-name ens33 ifname ens33 type ethernet ipv4.method manual \</span>
    ivp4.ipaddress <span class="m">192</span>.168.46.151/24 ipv4.gateway <span class="m">192</span>.168.46.1
<span class="c1">#  nmcli con up ens33</span>
主机名字配置。
<span class="c1"># hostnamectl set-hostname centos-151</span>
</pre></div>
</div>
</div>
<div class="section" id="id38">
<h3>8.1.13.4. 安装bind软件<a class="headerlink" href="#id38" title="永久链接至标题">¶</a></h3>
<p>给所有主机安装bind.</p>
<p>我这里使用ansible批量安装了。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 给所有主机安装下bind,bind_utils工具</span>
<span class="o">[</span>root@centos7 ansible<span class="o">]</span><span class="c1"># ansible dns -m yum -a &#39;name=bind,bind-utils&#39;</span>
<span class="c1"># 编辑下配置文件， 然后copy配置文件到所有目标主机上去，省去后续配置麻烦。</span>
<span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># vim /etc/named.conf</span>
<span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># ansible dns -m copy -a &#39;src=/etc/named.conf dest=/etc/named.conf&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="id39">
<h3>8.1.13.5. 主根配置<a class="headerlink" href="#id39" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 自身是根了， 所有就不能有所有的互联网上的根了。替换掉。</span>
<span class="c1"># 修改前的</span>
zone <span class="s2">&quot;.&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> hint<span class="p">;</span>
        file <span class="s2">&quot;named.ca&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
<span class="c1"># 修改后的</span>
zone <span class="s2">&quot;.&quot;</span> IN <span class="o">{</span>
        <span class="nb">type</span> master<span class="p">;</span>
        file <span class="s2">&quot;root.zone&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>

<span class="o">[</span>root@151 named<span class="o">]</span><span class="c1"># cat root.zone</span>
<span class="nv">$TTL</span> 1D
@   IN SOA  ns1 admin <span class="o">(</span>
                    <span class="m">0</span>       <span class="p">;</span> serial
                    1D      <span class="p">;</span> refresh
                    1H      <span class="p">;</span> retry
                    1W      <span class="p">;</span> expire
                    3H <span class="o">)</span>    <span class="p">;</span> minimum
    NS      ns1
    NS      ns2
tech    NS      nstech
com     NS      nscom
ns1     A      <span class="m">192</span>.168.46.151
ns2     A   <span class="m">192</span>.168.46.152
nstech  A      <span class="m">192</span>.168.46.153
nscom   A      <span class="m">192</span>.168.46.154

<span class="c1"># 主的配置给从发送一份</span>
<span class="o">[</span>root@centos-151 named<span class="o">]</span><span class="c1"># scp /etc/named.conf  192.168.46.152:/etc/</span>
<span class="o">[</span>root@centos-151 named<span class="o">]</span><span class="c1"># systemctl restart named</span>
</pre></div>
</div>
</div>
<div class="section" id="id40">
<h3>8.1.13.6. 从根配置<a class="headerlink" href="#id40" title="永久链接至标题">¶</a></h3>
<p>上面已经copy过来一个named.conf文件， 修改下。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>zone <span class="s2">&quot;.&quot;</span> IN <span class="o">{</span>
    <span class="nb">type</span> slave<span class="p">;</span>
    masters <span class="o">{</span> <span class="m">192</span>.168.46.151<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
    file <span class="s2">&quot;slaves/root.zone&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id41">
<h3>8.1.13.7. 主从根测试<a class="headerlink" href="#id41" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 named<span class="o">]</span><span class="c1"># dig nstech  @localhost</span>
<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; nstech @localhost
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">32324</span>
<span class="p">;;</span> flags: qr aa rd ra<span class="p">;</span> QUERY: <span class="m">1</span>, ANSWER: <span class="m">1</span>, AUTHORITY: <span class="m">2</span>, ADDITIONAL: <span class="m">3</span>

<span class="p">;;</span> OPT PSEUDOSECTION:
<span class="p">;</span> EDNS: version: <span class="m">0</span>, flags:<span class="p">;</span> udp: <span class="m">4096</span>
<span class="p">;;</span> QUESTION SECTION:
<span class="p">;</span>nstech.                            IN      A

<span class="p">;;</span> ANSWER SECTION:
nstech.                     <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.153

<span class="p">;;</span> AUTHORITY SECTION:
.                   <span class="m">86400</span>   IN      NS      ns2.
.                   <span class="m">86400</span>   IN      NS      ns1.

<span class="p">;;</span> ADDITIONAL SECTION:
ns1.                        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.151
ns2.                        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.152

<span class="p">;;</span> Query time: <span class="m">0</span> msec
<span class="p">;;</span> SERVER: ::1#53<span class="o">(</span>::1<span class="o">)</span>
<span class="p">;;</span> WHEN: Sun Jan <span class="m">21</span> <span class="m">03</span>:41:58 CST <span class="m">2018</span>
<span class="p">;;</span> MSG SIZE  rcvd: <span class="m">115</span>
</pre></div>
</div>
</div>
<div class="section" id="id42">
<h3>8.1.13.8. 运营商配置<a class="headerlink" href="#id42" title="永久链接至标题">¶</a></h3>
<p>运营商为客户提供dns服务，默认的根是13个网络上的，配置在named.ca文件中， 我们修改为我们自己的2个根。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-158 named<span class="o">]</span><span class="c1"># vim named.ca</span>
<span class="o">[</span>root@centos-158 named<span class="o">]</span><span class="c1"># cat named.ca</span>

.                   <span class="m">518400</span>  IN      NS      a.root-servers.net.
.                   <span class="m">518400</span>  IN      NS      b.root-servers.net.
a.root-servers.net. <span class="m">3600000</span> IN      A       <span class="m">192</span>.168.46.151
b.root-servers.net. <span class="m">3600000</span> IN      A       <span class="m">192</span>.168.46.152
</pre></div>
</div>
<p>上面我们配置2个根， 一主一丛，这里需要对应的记录直接写入文件中去。</p>
</div>
<div class="section" id="id43">
<h3>8.1.13.9. 运营商测试<a class="headerlink" href="#id43" title="永久链接至标题">¶</a></h3>
<p>运营商的dns设置自身ip即可</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-158 named<span class="o">]</span><span class="c1"># dig ns1</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; ns1
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">8276</span>
<span class="p">;;</span> flags: qr rd ra<span class="p">;</span> QUERY: <span class="m">1</span>, ANSWER: <span class="m">1</span>, AUTHORITY: <span class="m">2</span>, ADDITIONAL: <span class="m">2</span>

<span class="p">;;</span> OPT PSEUDOSECTION:
<span class="p">;</span> EDNS: version: <span class="m">0</span>, flags:<span class="p">;</span> udp: <span class="m">4096</span>
<span class="p">;;</span> QUESTION SECTION:
<span class="p">;</span>ns1.                               IN      A

<span class="p">;;</span> ANSWER SECTION:
ns1.                        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.151

<span class="p">;;</span> AUTHORITY SECTION:
.                   <span class="m">86400</span>   IN      NS      ns2.
.                   <span class="m">86400</span>   IN      NS      ns1.

<span class="p">;;</span> ADDITIONAL SECTION:
ns2.                        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.152

<span class="p">;;</span> Query time: <span class="m">1</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.46.158#53<span class="o">(</span><span class="m">192</span>.168.46.158<span class="o">)</span>
<span class="p">;;</span> WHEN: Sun Jan <span class="m">21</span> <span class="m">04</span>:11:21 CST <span class="m">2018</span>
<span class="p">;;</span> MSG SIZE  rcvd: <span class="m">93</span>
</pre></div>
</div>
</div>
<div class="section" id="id44">
<h3>8.1.13.10. 客户端配置<a class="headerlink" href="#id44" title="永久链接至标题">¶</a></h3>
<p>客户端的dns设置为运营商的dns即可</p>
<p>客户端修改dns为运营商的ip即可</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-159 ~<span class="o">]</span><span class="c1"># nmcli con modify ens33 ipv4.gateway 192.168.46.158 ipv4.dns 192.168.46.158</span>
<span class="o">[</span>root@centos-159 ~<span class="o">]</span><span class="c1"># nmcli con up ens33</span>
</pre></div>
</div>
<p>测试下</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-159 ~<span class="o">]</span><span class="c1"># dig nstech</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; nstech
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">64966</span>
<span class="p">;;</span> flags: qr rd ra<span class="p">;</span> QUERY: <span class="m">1</span>, ANSWER: <span class="m">1</span>, AUTHORITY: <span class="m">2</span>, ADDITIONAL: <span class="m">3</span>

<span class="p">;;</span> OPT PSEUDOSECTION:
<span class="p">;</span> EDNS: version: <span class="m">0</span>, flags:<span class="p">;</span> udp: <span class="m">4096</span>
<span class="p">;;</span> QUESTION SECTION:
<span class="p">;</span>nstech.                            IN      A

<span class="p">;;</span> ANSWER SECTION:
nstech.                     <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.153

<span class="p">;;</span> AUTHORITY SECTION:
.                   <span class="m">86343</span>   IN      NS      ns2.
.                   <span class="m">86343</span>   IN      NS      ns1.

<span class="p">;;</span> ADDITIONAL SECTION:
ns2.                        <span class="m">86343</span>   IN      A       <span class="m">192</span>.168.46.152
ns1.                        <span class="m">86343</span>   IN      A       <span class="m">192</span>.168.46.151

<span class="p">;;</span> Query time: <span class="m">1</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.46.158#53<span class="o">(</span><span class="m">192</span>.168.46.158<span class="o">)</span>
<span class="p">;;</span> WHEN: Sun Jan <span class="m">21</span> <span class="m">04</span>:12:18 CST <span class="m">2018</span>
<span class="p">;;</span> MSG SIZE  rcvd: <span class="m">115</span>
</pre></div>
</div>
</div>
<div class="section" id="id45">
<h3>8.1.13.11. 一级域的配置<a class="headerlink" href="#id45" title="永久链接至标题">¶</a></h3>
<p>一级域有2个，tech和com域的，</p>
<p>先配置tech域</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-153 ~<span class="o">]</span><span class="c1"># vim /etc/named.conf</span>
<span class="o">[</span>root@centos-153 ~<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones</span>
<span class="o">[</span>root@centos-153 ~<span class="o">]</span><span class="c1"># tail -n 5 /etc/named.rfc1912.zones</span>

zone <span class="s2">&quot;tech&quot;</span> IN <span class="o">{</span>
    <span class="nb">type</span> master<span class="p">;</span>
    file <span class="s2">&quot;tech.zone&quot;</span><span class="p">;</span>
<span class="o">}</span> <span class="p">;</span>

<span class="o">[</span>root@centos-153 ~<span class="o">]</span><span class="c1"># cd /var/named/</span>
<span class="o">[</span>root@centos-153 named<span class="o">]</span><span class="c1"># ls</span>
data  dynamic  named.ca  named.empty  named.localhost  named.loopback  slaves
<span class="o">[</span>root@centos-153 named<span class="o">]</span><span class="c1"># cp named.localhost  tech.zone -p</span>
<span class="o">[</span>root@centos-153 named<span class="o">]</span><span class="c1"># vim tech.zone</span>
<span class="o">[</span>root@centos-153 named<span class="o">]</span><span class="c1"># cat tech.zone</span>
<span class="nv">$TTL</span> 1D
@   IN SOA  ns1 admin <span class="o">(</span>
                    <span class="m">0</span>       <span class="p">;</span> serial
                    1D      <span class="p">;</span> refresh
                    1H      <span class="p">;</span> retry
                    1W      <span class="p">;</span> expire
                    3H <span class="o">)</span>    <span class="p">;</span> minimum
    NS       ns1
linuxpanda NS    nslinuxpanda
ns1      A       <span class="m">192</span>.168.46.153
nslinuxpanda A    <span class="m">192</span>.168.46.155
<span class="o">[</span>root@centos-153 named<span class="o">]</span><span class="c1"># systemctl restart named</span>
<span class="o">[</span>root@centos-153 named<span class="o">]</span><span class="c1"># systemctl status named</span>
<span class="o">[</span>root@centos-153 named<span class="o">]</span><span class="c1"># dig ns1.tech</span>
</pre></div>
</div>
<p>在配置com域</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-154 ~<span class="o">]</span><span class="c1"># vim /etc/named.conf</span>
<span class="o">[</span>root@centos-154 ~<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones</span>
<span class="o">[</span>root@centos-154 ~<span class="o">]</span><span class="c1"># tail -n 5 /etc/named.rfc1912.zones</span>
<span class="o">}</span><span class="p">;</span>
zone <span class="s2">&quot;com&quot;</span> <span class="o">{</span>
    <span class="nb">type</span> master<span class="p">;</span>
    file <span class="s2">&quot;com.zone&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
<span class="o">[</span>root@centos-154 ~<span class="o">]</span><span class="c1"># cd /var/named/</span>
<span class="o">[</span>root@centos-154 named<span class="o">]</span><span class="c1"># cp named.localhost  com.zone -p</span>
<span class="o">[</span>root@centos-154 named<span class="o">]</span><span class="c1"># vim com.zone</span>
<span class="o">[</span>root@centos-154 named<span class="o">]</span><span class="c1"># cat com.zone</span>
<span class="nv">$TTL</span> 1D
@   IN SOA  ns1 admin <span class="o">(</span>
                    <span class="m">0</span>       <span class="p">;</span> serial
                    1D      <span class="p">;</span> refresh
                    1H      <span class="p">;</span> retry
                    1W      <span class="p">;</span> expire
                    3H <span class="o">)</span>    <span class="p">;</span> minimum
    NS      ns1
ns1     A       <span class="m">192</span>.168.46.154
<span class="o">[</span>root@centos-154 named<span class="o">]</span><span class="c1"># dig ns1.com</span>
</pre></div>
</div>
</div>
<div class="section" id="id46">
<h3>8.1.13.12. 顶级域测试<a class="headerlink" href="#id46" title="永久链接至标题">¶</a></h3>
<p>上面已经在顶级域的自己机器上面测试了，这次直接在客户端测试下，确保没错误</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-159 ~<span class="o">]</span><span class="c1"># dig ns1.tech</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; ns1.tech
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opcode: QUERY, status: NOERROR, id: 24895</span>
<span class="s">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 1</span>

<span class="s">;; OPT PSEUDOSECTION:</span>
<span class="s">; EDNS: version: 0, flags:; udp: 4096</span>
<span class="s">;; QUESTION SECTION:</span>
<span class="s">;ns1.tech.                  IN      A</span>

<span class="s">;; ANSWER SECTION:</span>
<span class="s">ns1.tech.           86400   IN      A       192.168.46.153</span>

<span class="s">;; AUTHORITY SECTION:</span>
<span class="s">tech.                       86400   IN      NS      ns1.tech.</span>

<span class="s">;; Query time: 1 msec</span>
<span class="s">;; SERVER: 192.168.46.158#53(192.168.46.158)</span>
<span class="s">;; WHEN: Sun Jan 21 04:27:50 CST 2018</span>
<span class="s">;; MSG SIZE  rcvd: 67</span>

<span class="s">[root@centos-159 ~]# dig ns1.com</span>

<span class="s">; &lt;&lt;&gt;&gt; DiG 9.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; ns1.com</span>
<span class="s">;; global options: +cmd</span>
<span class="s">;; Got answer:</span>
<span class="s">;; -&gt;&gt;HEADER&lt;&lt;- opcode</span>: QUERY, status: NOERROR, id: <span class="m">63104</span>
<span class="p">;;</span> flags: qr rd ra<span class="p">;</span> QUERY: <span class="m">1</span>, ANSWER: <span class="m">1</span>, AUTHORITY: <span class="m">1</span>, ADDITIONAL: <span class="m">1</span>

<span class="p">;;</span> OPT PSEUDOSECTION:
<span class="p">;</span> EDNS: version: <span class="m">0</span>, flags:<span class="p">;</span> udp: <span class="m">4096</span>
<span class="p">;;</span> QUESTION SECTION:
<span class="p">;</span>ns1.com.                   IN      A

<span class="p">;;</span> ANSWER SECTION:
ns1.com.            <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.154

<span class="p">;;</span> AUTHORITY SECTION:
com.                        <span class="m">86078</span>   IN      NS      ns1.com.

<span class="p">;;</span> Query time: <span class="m">1</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.46.158#53<span class="o">(</span><span class="m">192</span>.168.46.158<span class="o">)</span>
<span class="p">;;</span> WHEN: Sun Jan <span class="m">21</span> <span class="m">04</span>:28:01 CST <span class="m">2018</span>
<span class="p">;;</span> MSG SIZE  rcvd: <span class="m">66</span>
</pre></div>
</div>
</div>
<div class="section" id="id47">
<h3>8.1.13.13. 二级域配置<a class="headerlink" href="#id47" title="永久链接至标题">¶</a></h3>
<p>二级域里面我只有tech下的linuxpanda域，</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-155 ~<span class="o">]</span><span class="c1"># vim /etc/named.conf</span>
<span class="o">[</span>root@centos-155 named<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones</span>
<span class="o">[</span>root@centos-155 named<span class="o">]</span><span class="c1"># tail -n 5 /etc/named.rfc1912.zones</span>
<span class="o">}</span><span class="p">;</span>
zone <span class="s2">&quot;linuxpanda.tech&quot;</span> <span class="o">{</span>
    <span class="nb">type</span> master<span class="p">;</span>
    file <span class="s2">&quot;linuxpanda.tech.zone&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
<span class="o">[</span>root@centos-155 named<span class="o">]</span><span class="c1"># cd /var/named/</span>
<span class="o">[</span>root@centos-155 named<span class="o">]</span><span class="c1"># cp named.localhost  linuxpanda.tech.zone -p</span>
<span class="o">[</span>root@centos-155 named<span class="o">]</span><span class="c1"># vim linuxpanda.tech.zone</span>
<span class="o">[</span>root@centos-155 named<span class="o">]</span><span class="c1"># cat linuxpanda.tech.zone</span>
<span class="nv">$TTL</span> 1D
@   IN SOA  ns1 admin <span class="o">(</span>
                    <span class="m">0</span>       <span class="p">;</span> serial
                    1D      <span class="p">;</span> refresh
                    1H      <span class="p">;</span> retry
                    1W      <span class="p">;</span> expire
                    3H <span class="o">)</span>    <span class="p">;</span> minimum
    NS      ns1
ns1     A       <span class="m">192</span>.168.46.155
www     A       <span class="m">192</span>.168.46.156
www     A       <span class="m">192</span>.168.46.157

<span class="o">[</span>root@centos-155 named<span class="o">]</span><span class="c1"># dig www.linuxpanda.tech</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; www.linuxpanda.tech
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">20201</span>
<span class="p">;;</span> flags: qr aa rd ra<span class="p">;</span> QUERY: <span class="m">1</span>, ANSWER: <span class="m">2</span>, AUTHORITY: <span class="m">1</span>, ADDITIONAL: <span class="m">2</span>

<span class="p">;;</span> OPT PSEUDOSECTION:
<span class="p">;</span> EDNS: version: <span class="m">0</span>, flags:<span class="p">;</span> udp: <span class="m">4096</span>
<span class="p">;;</span> QUESTION SECTION:
<span class="p">;</span>www.linuxpanda.tech.               IN      A

<span class="p">;;</span> ANSWER SECTION:
www.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.157
www.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.156

<span class="p">;;</span> AUTHORITY SECTION:
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns1.linuxpanda.tech.

<span class="p">;;</span> ADDITIONAL SECTION:
ns1.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.155

<span class="p">;;</span> Query time: <span class="m">0</span> msec
<span class="p">;;</span> SERVER: <span class="m">127</span>.0.0.1#53<span class="o">(</span><span class="m">127</span>.0.0.1<span class="o">)</span>
<span class="p">;;</span> WHEN: Sun Jan <span class="m">21</span> <span class="m">04</span>:34:38 CST <span class="m">2018</span>
<span class="p">;;</span> MSG SIZE  rcvd: <span class="m">114</span>
</pre></div>
</div>
</div>
<div class="section" id="id48">
<h3>8.1.13.14. 三级域配置<a class="headerlink" href="#id48" title="永久链接至标题">¶</a></h3>
<p>上面在三级域配置的自己主机上测试过了，我们在在客户机上测试下</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-159 ~<span class="o">]</span><span class="c1"># dig www.linuxpanda.tech</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; www.linuxpanda.tech
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">25268</span>
<span class="p">;;</span> flags: qr rd ra<span class="p">;</span> QUERY: <span class="m">1</span>, ANSWER: <span class="m">2</span>, AUTHORITY: <span class="m">1</span>, ADDITIONAL: <span class="m">2</span>

<span class="p">;;</span> OPT PSEUDOSECTION:
<span class="p">;</span> EDNS: version: <span class="m">0</span>, flags:<span class="p">;</span> udp: <span class="m">4096</span>
<span class="p">;;</span> QUESTION SECTION:
<span class="p">;</span>www.linuxpanda.tech.               IN      A

<span class="p">;;</span> ANSWER SECTION:
www.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.157
www.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.156

<span class="p">;;</span> AUTHORITY SECTION:
linuxpanda.tech.    <span class="m">86400</span>   IN      NS      ns1.linuxpanda.tech.

<span class="p">;;</span> ADDITIONAL SECTION:
ns1.linuxpanda.tech.        <span class="m">86400</span>   IN      A       <span class="m">192</span>.168.46.155

<span class="p">;;</span> Query time: <span class="m">2</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.46.158#53<span class="o">(</span><span class="m">192</span>.168.46.158<span class="o">)</span>
<span class="p">;;</span> WHEN: Sun Jan <span class="m">21</span> <span class="m">04</span>:36:10 CST <span class="m">2018</span>
<span class="p">;;</span> MSG SIZE  rcvd: <span class="m">114</span>
</pre></div>
</div>
</div>
<div class="section" id="web">
<h3>8.1.13.15. web配置<a class="headerlink" href="#web" title="永久链接至标题">¶</a></h3>
<p>马上就要结束了，哈哈。</p>
<p>www1主机配置下web</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-156 ~<span class="o">]</span><span class="c1">#  echo &quot;this is 192.168.46.156&quot; &gt; /var/www/html/index.html</span>
<span class="o">[</span>root@centos-156 ~<span class="o">]</span><span class="c1"># systemctl restart httpd</span>
<span class="o">[</span>root@centos-156 ~<span class="o">]</span><span class="c1"># curl localhost</span>
this is <span class="m">192</span>.168.46.156
</pre></div>
</div>
<p>www2主机配置下web</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-157 ~<span class="o">]</span><span class="c1">#  echo &quot;this is 192.168.46.157&quot; &gt; /var/www/html/index.html</span>
<span class="o">[</span>root@centos-157 ~<span class="o">]</span><span class="c1"># systemctl restart httpd</span>
<span class="o">[</span>root@centos-157 ~<span class="o">]</span><span class="c1"># curl localhost</span>
this is <span class="m">192</span>.168.46.157
</pre></div>
</div>
</div>
<div class="section" id="id49">
<h3>8.1.13.16. 客户端最终测试<a class="headerlink" href="#id49" title="永久链接至标题">¶</a></h3>
<p>dns测试</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-159 ~<span class="o">]</span><span class="c1"># dig www.linuxpanda.tech</span>

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG <span class="m">9</span>.9.4-RedHat-9.9.4-50.el7 &lt;&lt;&gt;&gt; www.linuxpanda.tech
<span class="p">;;</span> global options: +cmd
<span class="p">;;</span> Got answer:
<span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">22715</span>
<span class="p">;;</span> flags: qr rd ra<span class="p">;</span> QUERY: <span class="m">1</span>, ANSWER: <span class="m">2</span>, AUTHORITY: <span class="m">1</span>, ADDITIONAL: <span class="m">2</span>

<span class="p">;;</span> OPT PSEUDOSECTION:
<span class="p">;</span> EDNS: version: <span class="m">0</span>, flags:<span class="p">;</span> udp: <span class="m">4096</span>
<span class="p">;;</span> QUESTION SECTION:
<span class="p">;</span>www.linuxpanda.tech.               IN      A

<span class="p">;;</span> ANSWER SECTION:
www.linuxpanda.tech.        <span class="m">85972</span>   IN      A       <span class="m">192</span>.168.46.156
www.linuxpanda.tech.        <span class="m">85972</span>   IN      A       <span class="m">192</span>.168.46.157

<span class="p">;;</span> AUTHORITY SECTION:
linuxpanda.tech.    <span class="m">85972</span>   IN      NS      ns1.linuxpanda.tech.

<span class="p">;;</span> ADDITIONAL SECTION:
ns1.linuxpanda.tech.        <span class="m">85972</span>   IN      A       <span class="m">192</span>.168.46.155

<span class="p">;;</span> Query time: <span class="m">0</span> msec
<span class="p">;;</span> SERVER: <span class="m">192</span>.168.46.158#53<span class="o">(</span><span class="m">192</span>.168.46.158<span class="o">)</span>
<span class="p">;;</span> WHEN: Sun Jan <span class="m">21</span> <span class="m">04</span>:43:18 CST <span class="m">2018</span>
<span class="p">;;</span> MSG SIZE  rcvd: <span class="m">114</span>
</pre></div>
</div>
<p>web服务测试</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-159 ~<span class="o">]</span><span class="c1"># for i in `seq 1 20 ` ; do curl http://www.linuxpanda.tech ; done</span>
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.156
this is <span class="m">192</span>.168.46.156
this is <span class="m">192</span>.168.46.156
this is <span class="m">192</span>.168.46.156
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.156
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.156
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.156
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.157
this is <span class="m">192</span>.168.46.156
this is <span class="m">192</span>.168.46.156
</pre></div>
</div>
</div>
</div>
<div class="section" id="id50">
<h2>8.1.14. 压力测试<a class="headerlink" href="#id50" title="永久链接至标题">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>queryperf -d test.txt -s <span class="m">127</span>.0.0.1
</pre></div>
</div>
</div>
<div class="section" id="id51">
<h2>8.1.15. 排错思路<a class="headerlink" href="#id51" title="永久链接至标题">¶</a></h2>
<ol class="arabic simple">
<li>查看日志信息</li>
<li>rndc querylog 启动日志临时获取查询详细信息</li>
<li>查看监听</li>
<li>查看zone权限配置</li>
<li>查看named.conf文件的allow-query和安全设置</li>
<li>使用named-checkconf和named-checkzone工具</li>
<li>dns配置是否正确。</li>
</ol>
</div>
<div class="section" id="id52">
<h2>8.1.16. 编译安装主要步骤<a class="headerlink" href="#id52" title="永久链接至标题">¶</a></h2>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1. 账号创建，文件下载，解压
2. 查看readme，install文档
3. dig -t NS . @a.root-servers.net. &gt;named.ca 。640
4. ./configure &amp;&amp; make &amp;&amp; make install
5. PATH , source path
6. named.conf文件，named.rfc1912.conf文件
7. rndc-confgen -r /dev/urandom
8. named -u named -f -g  -d 3 启动服务
9. cd contrib/queryperf
10. ./configure &amp;&amp; make  cp queryperf /user/local/bind9/bin/
11. queryperf -h
12. 做文件，www.linuxpandata.tech A 每行这样。
13. queryperf -d test.txt -s 127.0.0.1
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="unbound.html" class="btn btn-neutral float-right" title="8.2. unbound" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="8. DNS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, 张志佳.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'1.0',
            LANGUAGE:'zh_CN',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>